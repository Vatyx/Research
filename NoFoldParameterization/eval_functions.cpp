#include "eval_functions.h"
#include <math.h>
#include <float.h>
#include <stdio.h>
#include <algorithm> 
#include "vect.h"

double jason_function_tri(double L, double xx, double y, double u0, double v0, double u1, double v1, double u2, double v2)
{

	double den = 2 * L * y;
	double a = (-(u0*y) + u1*y - L*v0 + xx*v0 - xx*v1 + L*v2)/den;
	double b = (L*u0 - xx*u0 + xx*u1 - L*u2 - y*v0 + y*v1)/den;
	double c = (-(u0*y) + u1*y + L*v0 - xx*v0 + xx*v1 - L*v2)/den;
	double d = (xx*(u0 - u1) + L*(-u0 + u2) + y*(-v0 + v1))/den;
	
	return L*y*(2*(pow(a,2) + pow(b,2) + pow(c,2) + pow(d,2))*(1 + pow(pow(a,2) + pow(b,2) - pow(c,2) - pow(d,2),2)))/
   pow(pow(a,2) + pow(b,2) - pow(c,2) - pow(d,2),2);
}
void jason_function_grad(double *newgradient, double L, double xx, double y, double u0, double v0, double u1, double v1, double u2, double v2, int i, int ip1, int j)
//void jason_function_grad(double *newgradient, double L, double xx, double y, double u0, double v0, double u1, double v1, double u2, double v2)
{
	/*double area = u2*(-v0 + v1) + u1*(v0 - v2) + u0*(-v1 + v2);
		double area3 = pow ( area, 3 );
		newgradient[i*2] += (2*(area3*(L - xx)*(L*(u0 - u2) + (-u0 + u1)*xx) + (area3*(u0 - u1) + 
          pow(L,2)*(L*(v0 - v2) + (-v0 + v1)*xx)*(L*((u0 - u2)*(u1 - u2) + (v0 - v2)*(v1 - v2)) + ((-u0 + u1)*(u1 - u2) - (v0 - v1)*(v1 - v2))*xx))*pow(y,2) + 
       pow(L,2)*(v0 - v1)*((u0 - u1)*(u1 - u2) + (v0 - v1)*(v1 - v2))*pow(y,4)))/(area3*L*y);
		newgradient[i*2+1] += (-2*pow(L,2)*(u1 - u2)*pow(y,2)*(pow(L,2)*(pow(u0 - u2,2) + pow(v0 - v2,2)) - 2*L*((u0 - u1)*(u0 - u2) + (v0 - v1)*(v0 - v2))*xx + 
        (pow(u0 - u1,2) + pow(v0 - v1,2))*(pow(xx,2) + pow(y,2))) + 2*area3*(pow(L,2)*(v0 - v2) + L*(-2*v0 + v1 + v2)*xx + (v0 - v1)*(pow(xx,2) + pow(y,2))) + 
     2*area*pow(L,2)*pow(y,2)*(pow(L,2)*(v0 - v2) + L*(-2*v0 + v1 + v2)*xx + (v0 - v1)*(pow(xx,2) + pow(y,2))))/(area3*L*y);
		
		newgradient[ip1*2] += (2*area3*xx*(L*(u0 - u2) + (-u0 + u1)*xx) - 2*(area3*(u0 - u1) + 
        pow(L,2)*(L*(v0 - v2) + (-v0 + v1)*xx)*(L*(pow(u0 - u2,2) + pow(v0 - v2,2)) - ((u0 - u1)*(u0 - u2) + (v0 - v1)*(v0 - v2))*xx))*pow(y,2) - 
     2*pow(L,2)*(v0 - v1)*(pow(u0,2) + u1*u2 - u0*(u1 + u2) + (v0 - v1)*(v0 - v2))*pow(y,4))/(area3*L*y);
		newgradient[ip1*2+1] += (2*(area3*xx*(L*(v0 - v2) + (-v0 + v1)*xx) + (area3*(-v0 + v1) + 
          pow(L,2)*(L*(u0 - u2) + (-u0 + u1)*xx)*(L*(pow(u0 - u2,2) + pow(v0 - v2,2)) - (pow(u0,2) + u1*u2 - u0*(u1 + u2) + (v0 - v1)*(v0 - v2))*xx))*pow(y,2) + 
       pow(L,2)*(u0 - u1)*(pow(u0,2) + u1*u2 - u0*(u1 + u2) + (v0 - v1)*(v0 - v2))*pow(y,4)))/(area3*L*y);
	
		newgradient[j*2] += (2*(area3*(L*(-u0 + u2) + (u0 - u1)*xx) + area*pow(L,2)*(L*(-u0 + u2) + (u0 - u1)*xx)*pow(y,2) + 
       L*(v0 - v1)*pow(y,2)*(pow(L,2)*(pow(u0 - u2,2) + pow(v0 - v2,2)) - 2*L*((u0 - u1)*(u0 - u2) + (v0 - v1)*(v0 - v2))*xx + 
          (pow(u0 - u1,2) + pow(v0 - v1,2))*(pow(xx,2) + pow(y,2)))))/(area3*y);
		newgradient[j*2+1] += (2*(area3*(L*(-v0 + v2) + (v0 - v1)*xx) - L*(L*(u0 - u2) + (-u0 + u1)*xx)*(L*(pow(u0,2) + u1*u2 - u0*(u1 + u2) + (v0 - v1)*(v0 - v2)) - (pow(u0 - u1,2) + pow(v0 - v1,2))*xx)*
        pow(y,2) - L*(u0 - u1)*(pow(u0 - u1,2) + pow(v0 - v1,2))*pow(y,4)))/(area3*y);
*/

	double den = 2 * L * y;
	double a = (-(u0*y) + u1*y - L*v0 + xx*v0 - xx*v1 + L*v2)/den;
	double b = (L*u0 - xx*u0 + xx*u1 - L*u2 - y*v0 + y*v1)/den;
	double c = (-(u0*y) + u1*y + L*v0 - xx*v0 + xx*v1 - L*v2)/den;
	double d = (xx*(u0 - u1) + L*(-u0 + u2) + y*(-v0 + v1))/den;
	double a2b2mc2md2 = 2 * ( u2 * (v0-v1) + u0* (v1-v2) + u1 * (v2-v0) ) / den;
	double coeff1 = 1.0 + ( 3.0 * a2b2mc2md2 - 4.0 * (a * a + b * b ) ) / pow ( a2b2mc2md2, 3.0f );
	double coeff2 = 1.0 + ( 3.0 * a2b2mc2md2 + 4.0 * (c * c + d * d ) ) / pow ( a2b2mc2md2, 3.0f );

	//if(i != -1)
	{
		newgradient[i*2] += 2.0 * ( -a * coeff1 * y + b * coeff1 * (L-xx) - c * coeff2 * y + d * coeff2 * (xx-L));
		newgradient[i*2+1] += 2.0 * ( a * coeff1 * (xx-L) - b * coeff1 * y + c * coeff2 * (L-xx) - d * coeff2 * y );
		//newgradient[i*2] += (2.0/(((L)))/(((((u2)*((-(v0))+(v1)))+((u1)*((v0)+(-(v2))))+((u0)*((-(v1))+(v2))))*(((u2)*((-(v0))+(v1)))+((u1)*((v0)+(-(v2))))+((u0)*((-(v1))+(v2))))*(((u2)*((-(v0))+(v1)))+((u1)*((v0)+(-(v2))))+((u0)*((-(v1))+(v2))))))/(((y)))*(((L)*(((2.0)*(u0))+(-(u1))+(-(u2)))*((((u2)*((v0)+(-(v1))))+((u0)*((v1)+(-(v2))))+((u1)*((-(v0))+(v2))))*(((u2)*((v0)+(-(v1))))+((u0)*((v1)+(-(v2))))+((u1)*((-(v0))+(v2))))*(((u2)*((v0)+(-(v1))))+((u0)*((v1)+(-(v2))))+((u1)*((-(v0))+(v2)))))*(xx))+(((L)*(L)*(L)*(L))*((((u0)+(-(u2)))*((u1)+(-(u2))))+(((v0)+(-(v2)))*((v1)+(-(v2)))))*((v0)+(-(v2)))*((y)*(y)))+(((L)*(L)*(L))*((-((v0)+(-(v1)))*(((u2)*(u2))+((2.0)*((v0)+(-(v2)))*((v1)+(-(v2))))))+(((u1)*(u1))*((v0)+(-(v2))))+(-(u0)*((u1)+(-(u2)))*(((2.0)*(v0))+(-(v1))+(-(v2))))+((u1)*(u2)*((-(v1))+(v2))))*(xx)*((y)*(y)))+(-((u0)+(-(u1)))*((((u2)*((v0)+(-(v1))))+((u0)*((v1)+(-(v2))))+((u1)*((-(v0))+(v2))))*(((u2)*((v0)+(-(v1))))+((u0)*((v1)+(-(v2))))+((u1)*((-(v0))+(v2))))*(((u2)*((v0)+(-(v1))))+((u0)*((v1)+(-(v2))))+((u1)*((-(v0))+(v2)))))*(((xx)*(xx))+((y)*(y))))+(((L)*(L))*((-((u0)+(-(u2)))*((((u2)*((v0)+(-(v1))))+((u0)*((v1)+(-(v2))))+((u1)*((-(v0))+(v2))))*(((u2)*((v0)+(-(v1))))+((u0)*((v1)+(-(v2))))+((u1)*((-(v0))+(v2))))*(((u2)*((v0)+(-(v1))))+((u0)*((v1)+(-(v2))))+((u1)*((-(v0))+(v2))))))+(((-(v0))+(v1))*((-((u0)+(-(u1)))*((u1)+(-(u2))))+(-((v0)+(-(v1)))*((v1)+(-(v2)))))*((xx)*(xx))*((y)*(y)))+(((-(v0))+(v1))*((-((u0)+(-(u1)))*((u1)+(-(u2))))+(-((v0)+(-(v1)))*((v1)+(-(v2)))))*((y)*(y)*(y)*(y)))))));
		//newgradient[i*2+1] += (1.0/(((L)))/(((((u2)*((-(v0))+(v1)))+((u1)*((v0)+(-(v2))))+((u0)*((-(v1))+(v2))))*(((u2)*((-(v0))+(v1)))+((u1)*((v0)+(-(v2))))+((u0)*((-(v1))+(v2))))*(((u2)*((-(v0))+(v1)))+((u1)*((v0)+(-(v2))))+((u0)*((-(v1))+(v2))))))/(((y)))*(((2.0)*((u1)+(-(u2)))*((((u1)*(v0))+(-(u2)*(v0))+(-(u0)*(v1))+((u2)*(v1))+((u0)*(v2))+(-(u1)*(v2)))*(((u1)*(v0))+(-(u2)*(v0))+(-(u0)*(v1))+((u2)*(v1))+((u0)*(v2))+(-(u1)*(v2))))*((((L)*(L))*((((u0)+(-(u2)))*((u0)+(-(u2))))+(((v0)+(-(v2)))*((v0)+(-(v2))))))+((-2.0)*(L)*(((u0)*(u0))+((u1)*(u2))+(-(u0)*((u1)+(u2)))+(((v0)+(-(v1)))*((v0)+(-(v2)))))*(xx))+(((((u0)+(-(u1)))*((u0)+(-(u1))))+(((v0)+(-(v1)))*((v0)+(-(v1)))))*(((xx)*(xx))+((y)*(y))))))+((-2.0)*((u1)+(-(u2)))*(((((u1)*(v0))+(-(u2)*(v0))+(-(u0)*(v1))+((u2)*(v1))+((u0)*(v2))+(-(u1)*(v2)))*(((u1)*(v0))+(-(u2)*(v0))+(-(u0)*(v1))+((u2)*(v1))+((u0)*(v2))+(-(u1)*(v2))))+(((L)*(L))*((y)*(y))))*((((L)*(L))*((((u0)+(-(u2)))*((u0)+(-(u2))))+(((v0)+(-(v2)))*((v0)+(-(v2))))))+((-2.0)*(L)*(((u0)*(u0))+((u1)*(u2))+(-(u0)*((u1)+(u2)))+(((v0)+(-(v1)))*((v0)+(-(v2)))))*(xx))+(((((u0)+(-(u1)))*((u0)+(-(u1))))+(((v0)+(-(v1)))*((v0)+(-(v1)))))*(((xx)*(xx))+((y)*(y))))))+((2.0)*(((u2)*((-(v0))+(v1)))+((u1)*((v0)+(-(v2))))+((u0)*((-(v1))+(v2))))*(((((u1)*(v0))+(-(u2)*(v0))+(-(u0)*(v1))+((u2)*(v1))+((u0)*(v2))+(-(u1)*(v2)))*(((u1)*(v0))+(-(u2)*(v0))+(-(u0)*(v1))+((u2)*(v1))+((u0)*(v2))+(-(u1)*(v2))))+(((L)*(L))*((y)*(y))))*((((L)*(L))*((v0)+(-(v2))))+((L)*(((-2.0)*(v0))+(v1)+(v2))*(xx))+(((v0)+(-(v1)))*(((xx)*(xx))+((y)*(y))))))));;

		/*if( !_finite(tempa) || !_finite(tempb) )
		{
			printf("i = %d\n", i);
			printf("%f, %f, %f, %f, %f\n", u0,v0,u1,v1,u2,v2);
			printf("%f, %f, %f\n", L, xx, y);
			printf("%d, %d, %d\n", i,ip1,j);
			scanf("%d",tempa);
		}*/
	}

//	if(ip1 != -1)
	{
		//double tempa = (1.0/(((L)))/(((((u2)*((-(v0))+(v1)))+((u1)*((v0)+(-(v2))))+((u0)*((-(v1))+(v2))))*(((u2)*((-(v0))+(v1)))+((u1)*((v0)+(-(v2))))+((u0)*((-(v1))+(v2))))*(((u2)*((-(v0))+(v1)))+((u1)*((v0)+(-(v2))))+((u0)*((-(v1))+(v2))))))/(((y)))*(((-2.0)*(L)*((u0)+(-(u2)))*((((u2)*((v0)+(-(v1))))+((u0)*((v1)+(-(v2))))+((u1)*((-(v0))+(v2))))*(((u2)*((v0)+(-(v1))))+((u0)*((v1)+(-(v2))))+((u1)*((-(v0))+(v2))))*(((u2)*((v0)+(-(v1))))+((u0)*((v1)+(-(v2))))+((u1)*((-(v0))+(v2)))))*(xx))+((-2.0)*((L)*(L)*(L)*(L))*((((u0)+(-(u2)))*((u0)+(-(u2))))+(((v0)+(-(v2)))*((v0)+(-(v2)))))*((v0)+(-(v2)))*((y)*(y)))+((2.0)*((L)*(L)*(L))*((((v0)+(-(v1)))*(((u2)*(u2))+((2.0)*(((v0)+(-(v2)))*((v0)+(-(v2)))))))+((u1)*(u2)*((v0)+(-(v2))))+(((u0)*(u0))*(((2.0)*(v0))+(-(v1))+(-(v2))))+((u0)*(((u1)*((-(v0))+(v2)))+((u2)*(((-3.0)*(v0))+((2.0)*(v1))+(v2))))))*(xx)*((y)*(y)))+((2.0)*((u0)+(-(u1)))*((((u2)*((v0)+(-(v1))))+((u0)*((v1)+(-(v2))))+((u1)*((-(v0))+(v2))))*(((u2)*((v0)+(-(v1))))+((u0)*((v1)+(-(v2))))+((u1)*((-(v0))+(v2))))*(((u2)*((v0)+(-(v1))))+((u0)*((v1)+(-(v2))))+((u1)*((-(v0))+(v2)))))*(((xx)*(xx))+((y)*(y))))+((-2.0)*((L)*(L))*((v0)+(-(v1)))*(((u0)*(u0))+((u1)*(u2))+(-(u0)*((u1)+(u2)))+(((v0)+(-(v1)))*((v0)+(-(v2)))))*((y)*(y))*(((xx)*(xx))+((y)*(y))))));;
		//double tempb = (2.0/(((L)))/(((((u2)*((-(v0))+(v1)))+((u1)*((v0)+(-(v2))))+((u0)*((-(v1))+(v2))))*(((u2)*((-(v0))+(v1)))+((u1)*((v0)+(-(v2))))+((u0)*((-(v1))+(v2))))*(((u2)*((-(v0))+(v1)))+((u1)*((v0)+(-(v2))))+((u0)*((-(v1))+(v2))))))/(((y)))*(((L)*((v0)+(-(v2)))*((((u2)*((-(v0))+(v1)))+((u1)*((v0)+(-(v2))))+((u0)*((-(v1))+(v2))))*(((u2)*((-(v0))+(v1)))+((u1)*((v0)+(-(v2))))+((u0)*((-(v1))+(v2))))*(((u2)*((-(v0))+(v1)))+((u1)*((v0)+(-(v2))))+((u0)*((-(v1))+(v2)))))*(xx))+(((L)*(L)*(L)*(L))*((u0)+(-(u2)))*((((u0)+(-(u2)))*((u0)+(-(u2))))+(((v0)+(-(v2)))*((v0)+(-(v2)))))*((y)*(y)))+(((L)*(L)*(L))*(((-2.0)*((u0)*(u0)*(u0)))+((2.0)*((u0)*(u0))*((u1)+((2.0)*(u2))))+((u1)*(((2.0)*((u2)*(u2)))+(((v0)+(-(v2)))*((v0)+(-(v2))))))+(-(u0)*(((2.0)*(u2)*(((2.0)*(u1))+(u2)))+(((v0)+(-(v2)))*(((2.0)*(v0))+(-(v1))+(-(v2))))))+((u2)*((v0)+(-(v1)))*((v0)+(-(v2)))))*(xx)*((y)*(y)))+(((v0)+(-(v1)))*((((u2)*((v0)+(-(v1))))+((u0)*((v1)+(-(v2))))+((u1)*((-(v0))+(v2))))*(((u2)*((v0)+(-(v1))))+((u0)*((v1)+(-(v2))))+((u1)*((-(v0))+(v2))))*(((u2)*((v0)+(-(v1))))+((u0)*((v1)+(-(v2))))+((u1)*((-(v0))+(v2)))))*(((xx)*(xx))+((y)*(y))))+(((L)*(L))*((u0)+(-(u1)))*(((u0)*(u0))+((u1)*(u2))+(-(u0)*((u1)+(u2)))+(((v0)+(-(v1)))*((v0)+(-(v2)))))*((y)*(y))*(((xx)*(xx))+((y)*(y))))));;

		newgradient[ip1*2] += 2.0 * ( a * coeff1 * y + b * coeff1 * xx + c * coeff2 * y - d * coeff2 * xx);
		newgradient[ip1*2+1] += 2.0 * ( -a * coeff1 * xx + b * coeff1 * y + c * coeff2 * xx + d * coeff2 * y );
//		newgradient[ip1*2] +=(1.0/(((L)))/(((((u2)*((-(v0))+(v1)))+((u1)*((v0)+(-(v2))))+((u0)*((-(v1))+(v2))))*(((u2)*((-(v0))+(v1)))+((u1)*((v0)+(-(v2))))+((u0)*((-(v1))+(v2))))*(((u2)*((-(v0))+(v1)))+((u1)*((v0)+(-(v2))))+((u0)*((-(v1))+(v2))))))/(((y)))*(((-2.0)*(L)*((u0)+(-(u2)))*((((u2)*((v0)+(-(v1))))+((u0)*((v1)+(-(v2))))+((u1)*((-(v0))+(v2))))*(((u2)*((v0)+(-(v1))))+((u0)*((v1)+(-(v2))))+((u1)*((-(v0))+(v2))))*(((u2)*((v0)+(-(v1))))+((u0)*((v1)+(-(v2))))+((u1)*((-(v0))+(v2)))))*(xx))+((-2.0)*((L)*(L)*(L)*(L))*((((u0)+(-(u2)))*((u0)+(-(u2))))+(((v0)+(-(v2)))*((v0)+(-(v2)))))*((v0)+(-(v2)))*((y)*(y)))+((2.0)*((L)*(L)*(L))*((((v0)+(-(v1)))*(((u2)*(u2))+((2.0)*(((v0)+(-(v2)))*((v0)+(-(v2)))))))+((u1)*(u2)*((v0)+(-(v2))))+(((u0)*(u0))*(((2.0)*(v0))+(-(v1))+(-(v2))))+((u0)*(((u1)*((-(v0))+(v2)))+((u2)*(((-3.0)*(v0))+((2.0)*(v1))+(v2))))))*(xx)*((y)*(y)))+((2.0)*((u0)+(-(u1)))*((((u2)*((v0)+(-(v1))))+((u0)*((v1)+(-(v2))))+((u1)*((-(v0))+(v2))))*(((u2)*((v0)+(-(v1))))+((u0)*((v1)+(-(v2))))+((u1)*((-(v0))+(v2))))*(((u2)*((v0)+(-(v1))))+((u0)*((v1)+(-(v2))))+((u1)*((-(v0))+(v2)))))*(((xx)*(xx))+((y)*(y))))+((-2.0)*((L)*(L))*((v0)+(-(v1)))*(((u0)*(u0))+((u1)*(u2))+(-(u0)*((u1)+(u2)))+(((v0)+(-(v1)))*((v0)+(-(v2)))))*((y)*(y))*(((xx)*(xx))+((y)*(y))))));
//		newgradient[ip1*2+1] +=(2.0/(((L)))/(((((u2)*((-(v0))+(v1)))+((u1)*((v0)+(-(v2))))+((u0)*((-(v1))+(v2))))*(((u2)*((-(v0))+(v1)))+((u1)*((v0)+(-(v2))))+((u0)*((-(v1))+(v2))))*(((u2)*((-(v0))+(v1)))+((u1)*((v0)+(-(v2))))+((u0)*((-(v1))+(v2))))))/(((y)))*(((L)*((v0)+(-(v2)))*((((u2)*((-(v0))+(v1)))+((u1)*((v0)+(-(v2))))+((u0)*((-(v1))+(v2))))*(((u2)*((-(v0))+(v1)))+((u1)*((v0)+(-(v2))))+((u0)*((-(v1))+(v2))))*(((u2)*((-(v0))+(v1)))+((u1)*((v0)+(-(v2))))+((u0)*((-(v1))+(v2)))))*(xx))+(((L)*(L)*(L)*(L))*((u0)+(-(u2)))*((((u0)+(-(u2)))*((u0)+(-(u2))))+(((v0)+(-(v2)))*((v0)+(-(v2)))))*((y)*(y)))+(((L)*(L)*(L))*(((-2.0)*((u0)*(u0)*(u0)))+((2.0)*((u0)*(u0))*((u1)+((2.0)*(u2))))+((u1)*(((2.0)*((u2)*(u2)))+(((v0)+(-(v2)))*((v0)+(-(v2))))))+(-(u0)*(((2.0)*(u2)*(((2.0)*(u1))+(u2)))+(((v0)+(-(v2)))*(((2.0)*(v0))+(-(v1))+(-(v2))))))+((u2)*((v0)+(-(v1)))*((v0)+(-(v2)))))*(xx)*((y)*(y)))+(((v0)+(-(v1)))*((((u2)*((v0)+(-(v1))))+((u0)*((v1)+(-(v2))))+((u1)*((-(v0))+(v2))))*(((u2)*((v0)+(-(v1))))+((u0)*((v1)+(-(v2))))+((u1)*((-(v0))+(v2))))*(((u2)*((v0)+(-(v1))))+((u0)*((v1)+(-(v2))))+((u1)*((-(v0))+(v2)))))*(((xx)*(xx))+((y)*(y))))+(((L)*(L))*((u0)+(-(u1)))*(((u0)*(u0))+((u1)*(u2))+(-(u0)*((u1)+(u2)))+(((v0)+(-(v1)))*((v0)+(-(v2)))))*((y)*(y))*(((xx)*(xx))+((y)*(y))))));

		/*if( !_finite(tempa) || !_finite(tempb) )
		{
			printf("ip1 = %d\n", i);
			printf("%f, %f, %f, %f, %f\n", u0,v0,u1,v1,u2,v2);
			printf("%f, %f, %f\n", L, xx, y);
			printf("%d, %d, %d\n", i,ip1,j);
			scanf("%d",tempa);
		}*/
	}

	//if(j != -1)
	{

		/*double tempa = (1.0/(((L)))/(((((u2)*((-(v0))+(v1)))+((u1)*((v0)+(-(v2))))+((u0)*((-(v1))+(v2))))*(((u2)*((-(v0))+(v1)))+((u1)*((v0)+(-(v2))))+((u0)*((-(v1))+(v2))))*(((u2)*((-(v0))+(v1)))+((u1)*((v0)+(-(v2))))+((u0)*((-(v1))+(v2))))))/(((y)))*(((-2.0)*(L)*(((u2)*((-(v0))+(v1)))+((u1)*((v0)+(-(v2))))+((u0)*((-(v1))+(v2))))*(((L)*((u0)+(-(u2))))+(((-(u0))+(u1))*(xx)))*(((((u1)*(v0))+(-(u2)*(v0))+(-(u0)*(v1))+((u2)*(v1))+((u0)*(v2))+(-(u1)*(v2)))*(((u1)*(v0))+(-(u2)*(v0))+(-(u0)*(v1))+((u2)*(v1))+((u0)*(v2))+(-(u1)*(v2))))+(((L)*(L))*((y)*(y)))))+((2.0)*((-(v0))+(v1))*((((u1)*(v0))+(-(u2)*(v0))+(-(u0)*(v1))+((u2)*(v1))+((u0)*(v2))+(-(u1)*(v2)))*(((u1)*(v0))+(-(u2)*(v0))+(-(u0)*(v1))+((u2)*(v1))+((u0)*(v2))+(-(u1)*(v2))))*((((L)*(L))*((((u0)+(-(u2)))*((u0)+(-(u2))))+(((v0)+(-(v2)))*((v0)+(-(v2))))))+((-2.0)*(L)*(((u0)*(u0))+((u1)*(u2))+(-(u0)*((u1)+(u2)))+(((v0)+(-(v1)))*((v0)+(-(v2)))))*(xx))+(((((u0)+(-(u1)))*((u0)+(-(u1))))+(((v0)+(-(v1)))*((v0)+(-(v1)))))*(((xx)*(xx))+((y)*(y))))))+((-2.0)*((-(v0))+(v1))*(((((u1)*(v0))+(-(u2)*(v0))+(-(u0)*(v1))+((u2)*(v1))+((u0)*(v2))+(-(u1)*(v2)))*(((u1)*(v0))+(-(u2)*(v0))+(-(u0)*(v1))+((u2)*(v1))+((u0)*(v2))+(-(u1)*(v2))))+(((L)*(L))*((y)*(y))))*((((L)*(L))*((((u0)+(-(u2)))*((u0)+(-(u2))))+(((v0)+(-(v2)))*((v0)+(-(v2))))))+((-2.0)*(L)*(((u0)*(u0))+((u1)*(u2))+(-(u0)*((u1)+(u2)))+(((v0)+(-(v1)))*((v0)+(-(v2)))))*(xx))+(((((u0)+(-(u1)))*((u0)+(-(u1))))+(((v0)+(-(v1)))*((v0)+(-(v1)))))*(((xx)*(xx))+((y)*(y))))))));
		double tempb = (2.0/(((((u2)*((-(v0))+(v1)))+((u1)*((v0)+(-(v2))))+((u0)*((-(v1))+(v2))))*(((u2)*((-(v0))+(v1)))+((u1)*((v0)+(-(v2))))+((u0)*((-(v1))+(v2))))*(((u2)*((-(v0))+(v1)))+((u1)*((v0)+(-(v2))))+((u0)*((-(v1))+(v2))))))/(((y)))*((((v0)+(-(v1)))*((((u2)*((-(v0))+(v1)))+((u1)*((v0)+(-(v2))))+((u0)*((-(v1))+(v2))))*(((u2)*((-(v0))+(v1)))+((u1)*((v0)+(-(v2))))+((u0)*((-(v1))+(v2))))*(((u2)*((-(v0))+(v1)))+((u1)*((v0)+(-(v2))))+((u0)*((-(v1))+(v2)))))*(xx))+(-((L)*(L)*(L))*((u0)+(-(u2)))*(((u0)*(u0))+((u1)*(u2))+(-(u0)*((u1)+(u2)))+(((v0)+(-(v1)))*((v0)+(-(v2)))))*((y)*(y)))+(((L)*(L))*(((2.0)*((u0)*(u0)*(u0)))+((-2.0)*((u1)*(u1))*(u2))+((-2.0)*((u0)*(u0))*(((2.0)*(u1))+(u2)))+(-(u2)*(((v0)+(-(v1)))*((v0)+(-(v1)))))+((u0)*(((2.0)*(u1)*((u1)+((2.0)*(u2))))+(((v0)+(-(v1)))*(((2.0)*(v0))+(-(v1))+(-(v2))))))+(-(u1)*((v0)+(-(v1)))*((v0)+(-(v2)))))*(xx)*((y)*(y)))+((L)*((((v0)+(-(v2)))*((((u2)*((v0)+(-(v1))))+((u0)*((v1)+(-(v2))))+((u1)*((-(v0))+(v2))))*(((u2)*((v0)+(-(v1))))+((u0)*((v1)+(-(v2))))+((u1)*((-(v0))+(v2))))*(((u2)*((v0)+(-(v1))))+((u0)*((v1)+(-(v2))))+((u1)*((-(v0))+(v2))))))+(((-(u0))+(u1))*((((u0)+(-(u1)))*((u0)+(-(u1))))+(((v0)+(-(v1)))*((v0)+(-(v1)))))*((xx)*(xx))*((y)*(y)))+(((-(u0))+(u1))*((((u0)+(-(u1)))*((u0)+(-(u1))))+(((v0)+(-(v1)))*((v0)+(-(v1)))))*((y)*(y)*(y)*(y)))))));
		if( !_finite(tempa) || !_finite(tempb) )
		{
			printf("ip1 = %d\n", i);
			printf("%f, %f, %f, %f, %f\n", u0,v0,u1,v1,u2,v2);
			printf("%f, %f, %f\n", L, xx, y);
			printf("%d, %d, %d\n", i,ip1,j);
			scanf("%d",tempa);
		}*/

		newgradient[j*2] += 2.0 * ( -b * coeff1 * L + d * coeff2 * L);
		newgradient[j*2+1] += 2.0 * ( a * coeff1 * L - c * coeff2 * L );
//		newgradient[j*2] +=(1.0/(((L)))/(((((u2)*((-(v0))+(v1)))+((u1)*((v0)+(-(v2))))+((u0)*((-(v1))+(v2))))*(((u2)*((-(v0))+(v1)))+((u1)*((v0)+(-(v2))))+((u0)*((-(v1))+(v2))))*(((u2)*((-(v0))+(v1)))+((u1)*((v0)+(-(v2))))+((u0)*((-(v1))+(v2))))))/(((y)))*(((-2.0)*(L)*(((u2)*((-(v0))+(v1)))+((u1)*((v0)+(-(v2))))+((u0)*((-(v1))+(v2))))*(((L)*((u0)+(-(u2))))+(((-(u0))+(u1))*(xx)))*(((((u1)*(v0))+(-(u2)*(v0))+(-(u0)*(v1))+((u2)*(v1))+((u0)*(v2))+(-(u1)*(v2)))*(((u1)*(v0))+(-(u2)*(v0))+(-(u0)*(v1))+((u2)*(v1))+((u0)*(v2))+(-(u1)*(v2))))+(((L)*(L))*((y)*(y)))))+((2.0)*((-(v0))+(v1))*((((u1)*(v0))+(-(u2)*(v0))+(-(u0)*(v1))+((u2)*(v1))+((u0)*(v2))+(-(u1)*(v2)))*(((u1)*(v0))+(-(u2)*(v0))+(-(u0)*(v1))+((u2)*(v1))+((u0)*(v2))+(-(u1)*(v2))))*((((L)*(L))*((((u0)+(-(u2)))*((u0)+(-(u2))))+(((v0)+(-(v2)))*((v0)+(-(v2))))))+((-2.0)*(L)*(((u0)*(u0))+((u1)*(u2))+(-(u0)*((u1)+(u2)))+(((v0)+(-(v1)))*((v0)+(-(v2)))))*(xx))+(((((u0)+(-(u1)))*((u0)+(-(u1))))+(((v0)+(-(v1)))*((v0)+(-(v1)))))*(((xx)*(xx))+((y)*(y))))))+((-2.0)*((-(v0))+(v1))*(((((u1)*(v0))+(-(u2)*(v0))+(-(u0)*(v1))+((u2)*(v1))+((u0)*(v2))+(-(u1)*(v2)))*(((u1)*(v0))+(-(u2)*(v0))+(-(u0)*(v1))+((u2)*(v1))+((u0)*(v2))+(-(u1)*(v2))))+(((L)*(L))*((y)*(y))))*((((L)*(L))*((((u0)+(-(u2)))*((u0)+(-(u2))))+(((v0)+(-(v2)))*((v0)+(-(v2))))))+((-2.0)*(L)*(((u0)*(u0))+((u1)*(u2))+(-(u0)*((u1)+(u2)))+(((v0)+(-(v1)))*((v0)+(-(v2)))))*(xx))+(((((u0)+(-(u1)))*((u0)+(-(u1))))+(((v0)+(-(v1)))*((v0)+(-(v1)))))*(((xx)*(xx))+((y)*(y))))))));
//		newgradient[j*2+1] += (2.0/(((((u2)*((-(v0))+(v1)))+((u1)*((v0)+(-(v2))))+((u0)*((-(v1))+(v2))))*(((u2)*((-(v0))+(v1)))+((u1)*((v0)+(-(v2))))+((u0)*((-(v1))+(v2))))*(((u2)*((-(v0))+(v1)))+((u1)*((v0)+(-(v2))))+((u0)*((-(v1))+(v2))))))/(((y)))*((((v0)+(-(v1)))*((((u2)*((-(v0))+(v1)))+((u1)*((v0)+(-(v2))))+((u0)*((-(v1))+(v2))))*(((u2)*((-(v0))+(v1)))+((u1)*((v0)+(-(v2))))+((u0)*((-(v1))+(v2))))*(((u2)*((-(v0))+(v1)))+((u1)*((v0)+(-(v2))))+((u0)*((-(v1))+(v2)))))*(xx))+(-((L)*(L)*(L))*((u0)+(-(u2)))*(((u0)*(u0))+((u1)*(u2))+(-(u0)*((u1)+(u2)))+(((v0)+(-(v1)))*((v0)+(-(v2)))))*((y)*(y)))+(((L)*(L))*(((2.0)*((u0)*(u0)*(u0)))+((-2.0)*((u1)*(u1))*(u2))+((-2.0)*((u0)*(u0))*(((2.0)*(u1))+(u2)))+(-(u2)*(((v0)+(-(v1)))*((v0)+(-(v1)))))+((u0)*(((2.0)*(u1)*((u1)+((2.0)*(u2))))+(((v0)+(-(v1)))*(((2.0)*(v0))+(-(v1))+(-(v2))))))+(-(u1)*((v0)+(-(v1)))*((v0)+(-(v2)))))*(xx)*((y)*(y)))+((L)*((((v0)+(-(v2)))*((((u2)*((v0)+(-(v1))))+((u0)*((v1)+(-(v2))))+((u1)*((-(v0))+(v2))))*(((u2)*((v0)+(-(v1))))+((u0)*((v1)+(-(v2))))+((u1)*((-(v0))+(v2))))*(((u2)*((v0)+(-(v1))))+((u0)*((v1)+(-(v2))))+((u1)*((-(v0))+(v2))))))+(((-(u0))+(u1))*((((u0)+(-(u1)))*((u0)+(-(u1))))+(((v0)+(-(v1)))*((v0)+(-(v1)))))*((xx)*(xx))*((y)*(y)))+(((-(u0))+(u1))*((((u0)+(-(u1)))*((u0)+(-(u1))))+(((v0)+(-(v1)))*((v0)+(-(v1)))))*((y)*(y)*(y)*(y)))))));
	}

	/*printf("%f, %f, %f, %f, %f\n",newgradient[i*2],newgradient[i*2+1],
		newgradient[ip1*2],newgradient[ip1*2+1],
		newgradient[j*2],newgradient[j*2+1] );*/
}

//
//

double paper_jason_function_tri(iso_pre *precomps, double u0, double v0, double u1, double v1, double u2, double v2)
{
	/*/
	//printf("%f,%f,%f,%f,%f,%f\n",u0,v0,u1,v1,u2,v2);
//	vect2d U1; U1[0] = u0; U1[1] = v0;
//	vect2d U2; U2[0] = u1; U2[1] = v1;
//	vect2d U3; U3[0] = u2; U3[1] = v2;

	double lu3u1,lu2u1,u31dotu21;
	lu3u1 = (u2 - u0) * (u2 - u0) + (v2 - v0) * (v2 - v0);
	lu2u1 = (u1 - u0) * (u1 - u0) + (v1 - v0) * (v1 - v0);
//	lu3u1 = (U3 - U1).length2();
//	lu2u1 = (U2-U1).length2();

	u31dotu21 = (u2 - u0) * (u1 - u0) + (v2 - v0) * (v1 - v0);
//	u31dotu21 = (U3 - U1).dot((U2 - U1));

	double s1s2 = .25f* ((lu3u1 * precomps->ld21  + lu2u1 * precomps->ld31)/precomps->Pt  - 2*( u31dotu21 * precomps->p3dotp2 ) / precomps->Pt  );

	precomps->area_uv = (.5f) * (u1* v0 - u2* v0 - u0* v1 + u2 *v1 + u0 *v2 - u1 *v2);
	double ns1ns2 = 1.0f + precomps->Pt2 / (precomps->area_uv*precomps->area_uv);

	precomps->p1 = s1s2;
	precomps->p2 = ns1ns2;

	return 2*s1s2 * ns1ns2;
	/*/
	// scott code
	precomps->area_uv = (u1* v0 - u2* v0 - u0* v1 + u2 *v1 + u0 *v2 - u1 *v2);
	precomps->gradlylyu0 = precomps->c00 * u0 + precomps->c01 * u1 + precomps->c02 * u2;
	precomps->gradlylyv0 = precomps->c00 * v0 + precomps->c01 * v1 + precomps->c02 * v2;
	precomps->gradlylyu1 = precomps->c01 * u0 + precomps->c11 * u1 + precomps->c12 * u2;
	precomps->gradlylyv1 = precomps->c01 * v0 + precomps->c11 * v1 + precomps->c12 * v2;
	precomps->gradlylyu2 = precomps->c02 * u0 + precomps->c12 * u1 + precomps->c22 * u2;
	precomps->gradlylyv2 = precomps->c02 * v0 + precomps->c12 * v1 + precomps->c22 * v2;
	precomps->num = (u0 * precomps->gradlylyu0 + u1 * precomps->gradlylyu1 + u2 * precomps->gradlylyu2 + v0 * precomps->gradlylyv0 + v1 * precomps->gradlylyv1 + v2 * precomps->gradlylyv2);
	precomps->denomQuad = (1.0 / (precomps->ly * precomps->ly));
	precomps->denomNonlin = (1.0 / (precomps->area_uv * precomps->area_uv));
	precomps->denom = precomps->denomQuad + precomps->denomNonlin;
	return precomps->num * precomps->denom;
	/**/
}
void paper_jason_function_grad(double *newgradient, iso_pre *precomps, double u0, double v0, double u1, double v1, double u2, double v2, int i, int ip1, int j)
{
	/*/
	double area_rat = precomps->Pt2 / pow(precomps->area_uv,3.0f);
	{
		newgradient[i*2] += 2*(precomps->p1 * ( (-1* area_rat ) * (-1*(v1 - v2)) ) + 
			                precomps->p2 *( (precomps->cot[1] + precomps->cot[2])*u0 - precomps->cot[1]*u2 - precomps->cot[2]*u1 ));

		newgradient[i*2+1] += 2*(precomps->p1 * ( (-1* area_rat ) * ((u1 - u2)) ) + 
							  precomps->p2 * ( (precomps->cot[1] + precomps->cot[2])*v0 - precomps->cot[1]*v2 - precomps->cot[2]*v1 ));
	}

	{
		newgradient[ip1*2] += 2*(precomps->p1 *  ( (-1* area_rat ) * (-1*(v2 - v0)) ) + 
							  precomps->p2 * ( (precomps->cot[0] + precomps->cot[2])*u1 - precomps->cot[0]*u2 - precomps->cot[2]*u0 ));
		newgradient[ip1*2+1] += 2*(precomps->p1 * ( (-1* area_rat ) * ((u2 - u0)) ) +  
							  precomps->p2 *  ( (precomps->cot[0] + precomps->cot[2])*v1 - precomps->cot[0]*v2 - precomps->cot[2]*v0 ));
	}

	{
		newgradient[j*2] += 2*(precomps->p1 * ( (-1* area_rat ) * (-1*(v0 - v1)) ) 
			+ precomps->p2 * ( (precomps->cot[1] + precomps->cot[0])*u2 - precomps->cot[1]*u0 - precomps->cot[0]*u1 ));
		newgradient[j*2+1] += 2*(precomps->p1 *  ( (-1* area_rat ) * ((u0 - u1)) )
			+ precomps->p2 * ( (precomps->cot[1] + precomps->cot[0])*v2 - precomps->cot[1]*v0 - precomps->cot[0]*v1 ));
	}

	/*/
	
	newgradient[i * 2] += precomps->gradlylyu0 * precomps->denom - (v2 - v1) * precomps->num / pow(precomps->area_uv, 3);
	newgradient[i * 2 + 1] += precomps->gradlylyv0 * precomps->denom - (u1 - u2) * precomps->num / pow(precomps->area_uv, 3);
	newgradient[ip1 * 2] += precomps->gradlylyu1 * precomps->denom - (v0 - v2) * precomps->num / pow(precomps->area_uv, 3);
	newgradient[ip1 * 2 + 1] += precomps->gradlylyv1 * precomps->denom - (u2 - u0) * precomps->num / pow(precomps->area_uv, 3);
	newgradient[j * 2] += precomps->gradlylyu2 * precomps->denom - (v1 - v0) * precomps->num / pow(precomps->area_uv, 3);
	newgradient[j * 2 + 1] += precomps->gradlylyv2 * precomps->denom - (u0 - u1) * precomps->num / pow(precomps->area_uv, 3);
	/**/
}

void paper_jason_function_grad_quad_nonlin(double *gradQuad, double *gradNonlin, iso_pre *precomps, double u0, double v0, double u1, double v1, double u2, double v2, int i, int ip1, int j)
{
	/*
	gradQuad[i * 2] += precomps->gradlylyu0 * precomps->denomQuad;
	gradQuad[i * 2 + 1] += precomps->gradlylyv0 * precomps->denomQuad;
	gradQuad[ip1 * 2] += precomps->gradlylyu1 * precomps->denomQuad;
	gradQuad[ip1 * 2 + 1] += precomps->gradlylyv1 * precomps->denomQuad;
	gradQuad[j * 2] += precomps->gradlylyu2 * precomps->denomQuad;
	gradQuad[j * 2 + 1] += precomps->gradlylyv2 * precomps->denomQuad;

	gradNonlin[i * 2] += precomps->gradlylyu0 * precomps->denomNonlin - (v2 - v1) * precomps->num / pow(precomps->area_uv, 3);
	gradNonlin[i * 2 + 1] += precomps->gradlylyv0 * precomps->denomNonlin - (u1 - u2) * precomps->num / pow(precomps->area_uv, 3);
	gradNonlin[ip1 * 2] += precomps->gradlylyu1 * precomps->denomNonlin - (v0 - v2) * precomps->num / pow(precomps->area_uv, 3);
	gradNonlin[ip1 * 2 + 1] += precomps->gradlylyv1 * precomps->denomNonlin - (u2 - u0) * precomps->num / pow(precomps->area_uv, 3);
	gradNonlin[j * 2] += precomps->gradlylyu2 * precomps->denomNonlin - (v1 - v0) * precomps->num / pow(precomps->area_uv, 3);
	gradNonlin[j * 2 + 1] += precomps->gradlylyv2 * precomps->denomNonlin - (u0 - u1) * precomps->num / pow(precomps->area_uv, 3);
	*/

	double L = precomps->L;
	double xx = precomps->x;
	double y = precomps->y;

	double den = 2 * L * y;
	double a = (-(u0*y) + u1*y - L*v0 + xx*v0 - xx*v1 + L*v2) / den;
	double b = (L*u0 - xx*u0 + xx*u1 - L*u2 - y*v0 + y*v1) / den;
	double c = (-(u0*y) + u1*y + L*v0 - xx*v0 + xx*v1 - L*v2) / den;
	double d = (xx*(u0 - u1) + L*(-u0 + u2) + y*(-v0 + v1)) / den;
	double a2b2mc2md2 = 2 * (u2 * (v0 - v1) + u0* (v1 - v2) + u1 * (v2 - v0)) / den;
	double coeff1 = (3.0 * a2b2mc2md2 - 4.0 * (a * a + b * b)) / pow(a2b2mc2md2, 3.0f);
	double coeff2 = (3.0 * a2b2mc2md2 + 4.0 * (c * c + d * d)) / pow(a2b2mc2md2, 3.0f);

/*	gradQuad[i * 2] += precomps->gradlylyu0 * precomps->denomQuad;
	gradQuad[i * 2 + 1] += precomps->gradlylyv0 * precomps->denomQuad;
	gradQuad[ip1 * 2] += precomps->gradlylyu1 * precomps->denomQuad;
	gradQuad[ip1 * 2 + 1] += precomps->gradlylyv1 * precomps->denomQuad;
	gradQuad[j * 2] += precomps->gradlylyu2 * precomps->denomQuad;
	gradQuad[j * 2 + 1] += precomps->gradlylyv2 * precomps->denomQuad;
*/
	gradQuad[i * 2] += (-(a+c) * y + (b-d) * (L - xx) );
	gradQuad[i * 2 + 1] += ((c-a) * (L-xx) - (b+d) * y );

	gradQuad[ip1 * 2] += ((a+c) * y + (b-d) * xx);
	gradQuad[ip1 * 2 + 1] += ((c-a) * xx + (b+d) * y);

	gradQuad[j * 2] += (d-b) * L;
	gradQuad[j * 2 + 1] += ((a-c) * L);


	gradNonlin[i * 2] += (-a * coeff1 * y + b * coeff1 * (L - xx) - c * coeff2 * y + d * coeff2 * (xx - L));
	gradNonlin[i * 2 + 1] += (a * coeff1 * (xx - L) - b * coeff1 * y + c * coeff2 * (L - xx) - d * coeff2 * y);

	gradNonlin[ip1 * 2] += (a * coeff1 * y + b * coeff1 * xx + c * coeff2 * y - d * coeff2 * xx);
	gradNonlin[ip1 * 2 + 1] += (-a * coeff1 * xx + b * coeff1 * y + c * coeff2 * xx + d * coeff2 * y);

	gradNonlin[j * 2] += (-b * coeff1 * L + d * coeff2 * L);
	gradNonlin[j * 2 + 1] += (a * coeff1 * L - c * coeff2 * L);
}

void paper_jason_function_hessian_quad(std::vector<Eigen::Triplet<double> > &hessianTrips, iso_pre *precomps, int i, int ip1, int j)
{
	hessianTrips.push_back(Eigen::Triplet<double>(i * 2, i * 2, precomps->c00 / (precomps->ly * precomps->ly)));
	hessianTrips.push_back(Eigen::Triplet<double>(i * 2, ip1 * 2, precomps->c01 / (precomps->ly * precomps->ly)));
	hessianTrips.push_back(Eigen::Triplet<double>(i * 2, j * 2, precomps->c02 / (precomps->ly * precomps->ly)));
	hessianTrips.push_back(Eigen::Triplet<double>(ip1 * 2, i * 2, precomps->c01 / (precomps->ly * precomps->ly)));
	hessianTrips.push_back(Eigen::Triplet<double>(ip1 * 2, ip1 * 2, precomps->c11 / (precomps->ly * precomps->ly)));
	hessianTrips.push_back(Eigen::Triplet<double>(ip1 * 2, j * 2, precomps->c12 / (precomps->ly * precomps->ly)));
	hessianTrips.push_back(Eigen::Triplet<double>(j * 2, i * 2, precomps->c02 / (precomps->ly * precomps->ly)));
	hessianTrips.push_back(Eigen::Triplet<double>(j * 2, ip1 * 2, precomps->c12 / (precomps->ly * precomps->ly)));
	hessianTrips.push_back(Eigen::Triplet<double>(j * 2, j * 2, precomps->c22 / (precomps->ly * precomps->ly)));

	hessianTrips.push_back(Eigen::Triplet<double>(i * 2 + 1, i * 2 + 1, precomps->c00 / (precomps->ly * precomps->ly)));
	hessianTrips.push_back(Eigen::Triplet<double>(i * 2 + 1, ip1 * 2 + 1, precomps->c01 / (precomps->ly * precomps->ly)));
	hessianTrips.push_back(Eigen::Triplet<double>(i * 2 + 1, j * 2 + 1, precomps->c02 / (precomps->ly * precomps->ly)));
	hessianTrips.push_back(Eigen::Triplet<double>(ip1 * 2 + 1, i * 2 + 1, precomps->c01 / (precomps->ly * precomps->ly)));
	hessianTrips.push_back(Eigen::Triplet<double>(ip1 * 2 + 1, ip1 * 2 + 1, precomps->c11 / (precomps->ly * precomps->ly)));
	hessianTrips.push_back(Eigen::Triplet<double>(ip1 * 2 + 1, j * 2 + 1, precomps->c12 / (precomps->ly * precomps->ly)));
	hessianTrips.push_back(Eigen::Triplet<double>(j * 2 + 1, i * 2 + 1, precomps->c02 / (precomps->ly * precomps->ly)));
	hessianTrips.push_back(Eigen::Triplet<double>(j * 2 + 1, ip1 * 2 + 1, precomps->c12 / (precomps->ly * precomps->ly)));
	hessianTrips.push_back(Eigen::Triplet<double>(j * 2 + 1, j * 2 + 1, precomps->c22 / (precomps->ly * precomps->ly)));
}

double yaron_function_tri(double L, double x, double y, double u0, double v0, double u1, double v1, double u2, double v2)
{
	return ((2.0)*(L)*(y)*(((((u2)*(((-1.0)*(v0))+(v1)))+((u1)*((v0)+((-1.0)*(v2))))+((u0)*(((-1.0)*(v1))+(v2))))*(((u2)*(((-1.0)*(v0))+(v1)))+((u1)*((v0)+((-1.0)*(v2))))+((u0)*(((-1.0)*(v1))+(v2)))))+(((L)*(L))*((y)*(y))))*1.0/((((((L)*(L))*((((u0)+((-1.0)*(u2)))*((u0)+((-1.0)*(u2))))+(((v0)+((-1.0)*(v2)))*((v0)+((-1.0)*(v2))))))+((-2.0)*(L)*(((u0)*(u0))+((u1)*(u2))+((-1.0)*(u0)*((u1)+(u2)))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v2)))))*(x))+(((((u0)+((-1.0)*(u1)))*((u0)+((-1.0)*(u1))))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v1)))))*(((x)*(x))+((y)*(y))))+pow((((-4.0)*((L)*(L))*((((u2)*(((-1.0)*(v0))+(v1)))+((u1)*((v0)+((-1.0)*(v2))))+((u0)*(((-1.0)*(v1))+(v2))))*(((u2)*(((-1.0)*(v0))+(v1)))+((u1)*((v0)+((-1.0)*(v2))))+((u0)*(((-1.0)*(v1))+(v2)))))*((y)*(y)))+(((((L)*(L))*((((u0)+((-1.0)*(u2)))*((u0)+((-1.0)*(u2))))+(((v0)+((-1.0)*(v2)))*((v0)+((-1.0)*(v2))))))+((-2.0)*(L)*(((u0)*(u0))+((u1)*(u2))+((-1.0)*(u0)*((u1)+(u2)))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v2)))))*(x))+(((((u0)+((-1.0)*(u1)))*((u0)+((-1.0)*(u1))))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v1)))))*(((x)*(x))+((y)*(y)))))*((((L)*(L))*((((u0)+((-1.0)*(u2)))*((u0)+((-1.0)*(u2))))+(((v0)+((-1.0)*(v2)))*((v0)+((-1.0)*(v2))))))+((-2.0)*(L)*(((u0)*(u0))+((u1)*(u2))+((-1.0)*(u0)*((u1)+(u2)))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v2)))))*(x))+(((((u0)+((-1.0)*(u1)))*((u0)+((-1.0)*(u1))))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v1)))))*(((x)*(x))+((y)*(y))))))),(1.0)/(2.0))))));
}
void yaron_function_grad(double *newgradient, double L, double x, double y, double u0, double v0, double u1, double v1, double u2, double v2, int i, int ip1, int j)
{
	if(i != -1)
	{
	newgradient[i*2] += ((2.0)*(L)*(y)*1.0/((((((L)*(L))*((((u0)+((-1.0)*(u2)))*((u0)+((-1.0)*(u2))))+(((v0)+((-1.0)*(v2)))*((v0)+((-1.0)*(v2))))))+((-2.0)*(L)*(((u0)*(u0))+((u1)*(u2))+((-1.0)*(u0)*((u1)+(u2)))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v2)))))*(x))+(((((u0)+((-1.0)*(u1)))*((u0)+((-1.0)*(u1))))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v1)))))*(((x)*(x))+((y)*(y))))+pow((((-4.0)*((L)*(L))*((((u2)*(((-1.0)*(v0))+(v1)))+((u1)*((v0)+((-1.0)*(v2))))+((u0)*(((-1.0)*(v1))+(v2))))*(((u2)*(((-1.0)*(v0))+(v1)))+((u1)*((v0)+((-1.0)*(v2))))+((u0)*(((-1.0)*(v1))+(v2)))))*((y)*(y)))+(((((L)*(L))*((((u0)+((-1.0)*(u2)))*((u0)+((-1.0)*(u2))))+(((v0)+((-1.0)*(v2)))*((v0)+((-1.0)*(v2))))))+((-2.0)*(L)*(((u0)*(u0))+((u1)*(u2))+((-1.0)*(u0)*((u1)+(u2)))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v2)))))*(x))+(((((u0)+((-1.0)*(u1)))*((u0)+((-1.0)*(u1))))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v1)))))*(((x)*(x))+((y)*(y)))))*((((L)*(L))*((((u0)+((-1.0)*(u2)))*((u0)+((-1.0)*(u2))))+(((v0)+((-1.0)*(v2)))*((v0)+((-1.0)*(v2))))))+((-2.0)*(L)*(((u0)*(u0))+((u1)*(u2))+((-1.0)*(u0)*((u1)+(u2)))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v2)))))*(x))+(((((u0)+((-1.0)*(u1)))*((u0)+((-1.0)*(u1))))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v1)))))*(((x)*(x))+((y)*(y))))))),(1.0)/(2.0)))*((((L)*(L))*((((u0)+((-1.0)*(u2)))*((u0)+((-1.0)*(u2))))+(((v0)+((-1.0)*(v2)))*((v0)+((-1.0)*(v2))))))+((-2.0)*(L)*(((u0)*(u0))+((u1)*(u2))+((-1.0)*(u0)*((u1)+(u2)))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v2)))))*(x))+(((((u0)+((-1.0)*(u1)))*((u0)+((-1.0)*(u1))))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v1)))))*(((x)*(x))+((y)*(y))))+pow((((-4.0)*((L)*(L))*((((u2)*(((-1.0)*(v0))+(v1)))+((u1)*((v0)+((-1.0)*(v2))))+((u0)*(((-1.0)*(v1))+(v2))))*(((u2)*(((-1.0)*(v0))+(v1)))+((u1)*((v0)+((-1.0)*(v2))))+((u0)*(((-1.0)*(v1))+(v2)))))*((y)*(y)))+(((((L)*(L))*((((u0)+((-1.0)*(u2)))*((u0)+((-1.0)*(u2))))+(((v0)+((-1.0)*(v2)))*((v0)+((-1.0)*(v2))))))+((-2.0)*(L)*(((u0)*(u0))+((u1)*(u2))+((-1.0)*(u0)*((u1)+(u2)))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v2)))))*(x))+(((((u0)+((-1.0)*(u1)))*((u0)+((-1.0)*(u1))))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v1)))))*(((x)*(x))+((y)*(y)))))*((((L)*(L))*((((u0)+((-1.0)*(u2)))*((u0)+((-1.0)*(u2))))+(((v0)+((-1.0)*(v2)))*((v0)+((-1.0)*(v2))))))+((-2.0)*(L)*(((u0)*(u0))+((u1)*(u2))+((-1.0)*(u0)*((u1)+(u2)))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v2)))))*(x))+(((((u0)+((-1.0)*(u1)))*((u0)+((-1.0)*(u1))))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v1)))))*(((x)*(x))+((y)*(y))))))),(1.0)/(2.0)))))*(((-1.0)*(((((u2)*(((-1.0)*(v0))+(v1)))+((u1)*((v0)+((-1.0)*(v2))))+((u0)*(((-1.0)*(v1))+(v2))))*(((u2)*(((-1.0)*(v0))+(v1)))+((u1)*((v0)+((-1.0)*(v2))))+((u0)*(((-1.0)*(v1))+(v2)))))+(((L)*(L))*((y)*(y))))*(((2.0)*((L)*(L))*((u0)+((-1.0)*(u2))))+((-2.0)*(L)*(((2.0)*(u0))+((-1.0)*(u1))+((-1.0)*(u2)))*(x))+((2.0)*((u0)+((-1.0)*(u1)))*(((x)*(x))+((y)*(y))))+((1.0)/(2.0)*(((8.0)*((L)*(L))*((v1)+((-1.0)*(v2)))*(((u2)*(((-1.0)*(v0))+(v1)))+((u1)*((v0)+((-1.0)*(v2))))+((u0)*(((-1.0)*(v1))+(v2))))*((y)*(y)))+((4.0)*((((L)*(L))*((u0)+((-1.0)*(u2))))+((L)*(((-2.0)*(u0))+(u1)+(u2))*(x))+(((u0)+((-1.0)*(u1)))*(((x)*(x))+((y)*(y)))))*((((L)*(L))*((((u0)+((-1.0)*(u2)))*((u0)+((-1.0)*(u2))))+(((v0)+((-1.0)*(v2)))*((v0)+((-1.0)*(v2))))))+((-2.0)*(L)*(((u0)*(u0))+((u1)*(u2))+((-1.0)*(u0)*((u1)+(u2)))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v2)))))*(x))+(((((u0)+((-1.0)*(u1)))*((u0)+((-1.0)*(u1))))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v1)))))*(((x)*(x))+((y)*(y)))))))*pow((((-4.0)*((L)*(L))*((((u2)*(((-1.0)*(v0))+(v1)))+((u1)*((v0)+((-1.0)*(v2))))+((u0)*(((-1.0)*(v1))+(v2))))*(((u2)*(((-1.0)*(v0))+(v1)))+((u1)*((v0)+((-1.0)*(v2))))+((u0)*(((-1.0)*(v1))+(v2)))))*((y)*(y)))+(((((L)*(L))*((((u0)+((-1.0)*(u2)))*((u0)+((-1.0)*(u2))))+(((v0)+((-1.0)*(v2)))*((v0)+((-1.0)*(v2))))))+((-2.0)*(L)*(((u0)*(u0))+((u1)*(u2))+((-1.0)*(u0)*((u1)+(u2)))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v2)))))*(x))+(((((u0)+((-1.0)*(u1)))*((u0)+((-1.0)*(u1))))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v1)))))*(((x)*(x))+((y)*(y)))))*((((L)*(L))*((((u0)+((-1.0)*(u2)))*((u0)+((-1.0)*(u2))))+(((v0)+((-1.0)*(v2)))*((v0)+((-1.0)*(v2))))))+((-2.0)*(L)*(((u0)*(u0))+((u1)*(u2))+((-1.0)*(u0)*((u1)+(u2)))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v2)))))*(x))+(((((u0)+((-1.0)*(u1)))*((u0)+((-1.0)*(u1))))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v1)))))*(((x)*(x))+((y)*(y))))))),(-1.0)/(2.0)))))+((2.0)*(((-1.0)*(v1))+(v2))*(((u2)*(((-1.0)*(v0))+(v1)))+((u1)*((v0)+((-1.0)*(v2))))+((u0)*(((-1.0)*(v1))+(v2))))*((((L)*(L))*((((u0)+((-1.0)*(u2)))*((u0)+((-1.0)*(u2))))+(((v0)+((-1.0)*(v2)))*((v0)+((-1.0)*(v2))))))+((-2.0)*(L)*(((u0)*(u0))+((u1)*(u2))+((-1.0)*(u0)*((u1)+(u2)))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v2)))))*(x))+(((((u0)+((-1.0)*(u1)))*((u0)+((-1.0)*(u1))))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v1)))))*(((x)*(x))+((y)*(y))))+pow((((-4.0)*((L)*(L))*((((u2)*(((-1.0)*(v0))+(v1)))+((u1)*((v0)+((-1.0)*(v2))))+((u0)*(((-1.0)*(v1))+(v2))))*(((u2)*(((-1.0)*(v0))+(v1)))+((u1)*((v0)+((-1.0)*(v2))))+((u0)*(((-1.0)*(v1))+(v2)))))*((y)*(y)))+(((((L)*(L))*((((u0)+((-1.0)*(u2)))*((u0)+((-1.0)*(u2))))+(((v0)+((-1.0)*(v2)))*((v0)+((-1.0)*(v2))))))+((-2.0)*(L)*(((u0)*(u0))+((u1)*(u2))+((-1.0)*(u0)*((u1)+(u2)))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v2)))))*(x))+(((((u0)+((-1.0)*(u1)))*((u0)+((-1.0)*(u1))))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v1)))))*(((x)*(x))+((y)*(y)))))*((((L)*(L))*((((u0)+((-1.0)*(u2)))*((u0)+((-1.0)*(u2))))+(((v0)+((-1.0)*(v2)))*((v0)+((-1.0)*(v2))))))+((-2.0)*(L)*(((u0)*(u0))+((u1)*(u2))+((-1.0)*(u0)*((u1)+(u2)))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v2)))))*(x))+(((((u0)+((-1.0)*(u1)))*((u0)+((-1.0)*(u1))))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v1)))))*(((x)*(x))+((y)*(y))))))),(1.0)/(2.0))))));
	newgradient[i*2+1] += ((2.0)*(L)*(y)*1.0/((((((L)*(L))*((((u0)+((-1.0)*(u2)))*((u0)+((-1.0)*(u2))))+(((v0)+((-1.0)*(v2)))*((v0)+((-1.0)*(v2))))))+((-2.0)*(L)*(((u0)*(u0))+((u1)*(u2))+((-1.0)*(u0)*((u1)+(u2)))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v2)))))*(x))+(((((u0)+((-1.0)*(u1)))*((u0)+((-1.0)*(u1))))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v1)))))*(((x)*(x))+((y)*(y))))+pow((((-4.0)*((L)*(L))*((((u2)*(((-1.0)*(v0))+(v1)))+((u1)*((v0)+((-1.0)*(v2))))+((u0)*(((-1.0)*(v1))+(v2))))*(((u2)*(((-1.0)*(v0))+(v1)))+((u1)*((v0)+((-1.0)*(v2))))+((u0)*(((-1.0)*(v1))+(v2)))))*((y)*(y)))+(((((L)*(L))*((((u0)+((-1.0)*(u2)))*((u0)+((-1.0)*(u2))))+(((v0)+((-1.0)*(v2)))*((v0)+((-1.0)*(v2))))))+((-2.0)*(L)*(((u0)*(u0))+((u1)*(u2))+((-1.0)*(u0)*((u1)+(u2)))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v2)))))*(x))+(((((u0)+((-1.0)*(u1)))*((u0)+((-1.0)*(u1))))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v1)))))*(((x)*(x))+((y)*(y)))))*((((L)*(L))*((((u0)+((-1.0)*(u2)))*((u0)+((-1.0)*(u2))))+(((v0)+((-1.0)*(v2)))*((v0)+((-1.0)*(v2))))))+((-2.0)*(L)*(((u0)*(u0))+((u1)*(u2))+((-1.0)*(u0)*((u1)+(u2)))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v2)))))*(x))+(((((u0)+((-1.0)*(u1)))*((u0)+((-1.0)*(u1))))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v1)))))*(((x)*(x))+((y)*(y))))))),(1.0)/(2.0)))*((((L)*(L))*((((u0)+((-1.0)*(u2)))*((u0)+((-1.0)*(u2))))+(((v0)+((-1.0)*(v2)))*((v0)+((-1.0)*(v2))))))+((-2.0)*(L)*(((u0)*(u0))+((u1)*(u2))+((-1.0)*(u0)*((u1)+(u2)))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v2)))))*(x))+(((((u0)+((-1.0)*(u1)))*((u0)+((-1.0)*(u1))))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v1)))))*(((x)*(x))+((y)*(y))))+pow((((-4.0)*((L)*(L))*((((u2)*(((-1.0)*(v0))+(v1)))+((u1)*((v0)+((-1.0)*(v2))))+((u0)*(((-1.0)*(v1))+(v2))))*(((u2)*(((-1.0)*(v0))+(v1)))+((u1)*((v0)+((-1.0)*(v2))))+((u0)*(((-1.0)*(v1))+(v2)))))*((y)*(y)))+(((((L)*(L))*((((u0)+((-1.0)*(u2)))*((u0)+((-1.0)*(u2))))+(((v0)+((-1.0)*(v2)))*((v0)+((-1.0)*(v2))))))+((-2.0)*(L)*(((u0)*(u0))+((u1)*(u2))+((-1.0)*(u0)*((u1)+(u2)))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v2)))))*(x))+(((((u0)+((-1.0)*(u1)))*((u0)+((-1.0)*(u1))))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v1)))))*(((x)*(x))+((y)*(y)))))*((((L)*(L))*((((u0)+((-1.0)*(u2)))*((u0)+((-1.0)*(u2))))+(((v0)+((-1.0)*(v2)))*((v0)+((-1.0)*(v2))))))+((-2.0)*(L)*(((u0)*(u0))+((u1)*(u2))+((-1.0)*(u0)*((u1)+(u2)))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v2)))))*(x))+(((((u0)+((-1.0)*(u1)))*((u0)+((-1.0)*(u1))))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v1)))))*(((x)*(x))+((y)*(y))))))),(1.0)/(2.0)))))*(((2.0)*((u1)+((-1.0)*(u2)))*(((u2)*(((-1.0)*(v0))+(v1)))+((u1)*((v0)+((-1.0)*(v2))))+((u0)*(((-1.0)*(v1))+(v2))))*((((L)*(L))*((((u0)+((-1.0)*(u2)))*((u0)+((-1.0)*(u2))))+(((v0)+((-1.0)*(v2)))*((v0)+((-1.0)*(v2))))))+((-2.0)*(L)*(((u0)*(u0))+((u1)*(u2))+((-1.0)*(u0)*((u1)+(u2)))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v2)))))*(x))+(((((u0)+((-1.0)*(u1)))*((u0)+((-1.0)*(u1))))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v1)))))*(((x)*(x))+((y)*(y))))+pow((((-4.0)*((L)*(L))*((((u2)*(((-1.0)*(v0))+(v1)))+((u1)*((v0)+((-1.0)*(v2))))+((u0)*(((-1.0)*(v1))+(v2))))*(((u2)*(((-1.0)*(v0))+(v1)))+((u1)*((v0)+((-1.0)*(v2))))+((u0)*(((-1.0)*(v1))+(v2)))))*((y)*(y)))+(((((L)*(L))*((((u0)+((-1.0)*(u2)))*((u0)+((-1.0)*(u2))))+(((v0)+((-1.0)*(v2)))*((v0)+((-1.0)*(v2))))))+((-2.0)*(L)*(((u0)*(u0))+((u1)*(u2))+((-1.0)*(u0)*((u1)+(u2)))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v2)))))*(x))+(((((u0)+((-1.0)*(u1)))*((u0)+((-1.0)*(u1))))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v1)))))*(((x)*(x))+((y)*(y)))))*((((L)*(L))*((((u0)+((-1.0)*(u2)))*((u0)+((-1.0)*(u2))))+(((v0)+((-1.0)*(v2)))*((v0)+((-1.0)*(v2))))))+((-2.0)*(L)*(((u0)*(u0))+((u1)*(u2))+((-1.0)*(u0)*((u1)+(u2)))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v2)))))*(x))+(((((u0)+((-1.0)*(u1)))*((u0)+((-1.0)*(u1))))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v1)))))*(((x)*(x))+((y)*(y))))))),(1.0)/(2.0))))+((-1.0)*(((((u2)*(((-1.0)*(v0))+(v1)))+((u1)*((v0)+((-1.0)*(v2))))+((u0)*(((-1.0)*(v1))+(v2))))*(((u2)*(((-1.0)*(v0))+(v1)))+((u1)*((v0)+((-1.0)*(v2))))+((u0)*(((-1.0)*(v1))+(v2)))))+(((L)*(L))*((y)*(y))))*(((2.0)*((L)*(L))*((v0)+((-1.0)*(v2))))+((-2.0)*(L)*(((2.0)*(v0))+((-1.0)*(v1))+((-1.0)*(v2)))*(x))+((2.0)*((v0)+((-1.0)*(v1)))*(((x)*(x))+((y)*(y))))+((1.0)/(2.0)*pow((((-4.0)*((L)*(L))*((((u2)*(((-1.0)*(v0))+(v1)))+((u1)*((v0)+((-1.0)*(v2))))+((u0)*(((-1.0)*(v1))+(v2))))*(((u2)*(((-1.0)*(v0))+(v1)))+((u1)*((v0)+((-1.0)*(v2))))+((u0)*(((-1.0)*(v1))+(v2)))))*((y)*(y)))+(((((L)*(L))*((((u0)+((-1.0)*(u2)))*((u0)+((-1.0)*(u2))))+(((v0)+((-1.0)*(v2)))*((v0)+((-1.0)*(v2))))))+((-2.0)*(L)*(((u0)*(u0))+((u1)*(u2))+((-1.0)*(u0)*((u1)+(u2)))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v2)))))*(x))+(((((u0)+((-1.0)*(u1)))*((u0)+((-1.0)*(u1))))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v1)))))*(((x)*(x))+((y)*(y)))))*((((L)*(L))*((((u0)+((-1.0)*(u2)))*((u0)+((-1.0)*(u2))))+(((v0)+((-1.0)*(v2)))*((v0)+((-1.0)*(v2))))))+((-2.0)*(L)*(((u0)*(u0))+((u1)*(u2))+((-1.0)*(u0)*((u1)+(u2)))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v2)))))*(x))+(((((u0)+((-1.0)*(u1)))*((u0)+((-1.0)*(u1))))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v1)))))*(((x)*(x))+((y)*(y))))))),(-1.0)/(2.0))*(((-8.0)*((L)*(L))*((u1)+((-1.0)*(u2)))*(((u2)*(((-1.0)*(v0))+(v1)))+((u1)*((v0)+((-1.0)*(v2))))+((u0)*(((-1.0)*(v1))+(v2))))*((y)*(y)))+((4.0)*((((L)*(L))*((((u0)+((-1.0)*(u2)))*((u0)+((-1.0)*(u2))))+(((v0)+((-1.0)*(v2)))*((v0)+((-1.0)*(v2))))))+((-2.0)*(L)*(((u0)*(u0))+((u1)*(u2))+((-1.0)*(u0)*((u1)+(u2)))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v2)))))*(x))+(((((u0)+((-1.0)*(u1)))*((u0)+((-1.0)*(u1))))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v1)))))*(((x)*(x))+((y)*(y)))))*((((L)*(L))*((v0)+((-1.0)*(v2))))+((L)*(((-2.0)*(v0))+(v1)+(v2))*(x))+(((v0)+((-1.0)*(v1)))*(((x)*(x))+((y)*(y))))))))))));
	}

	if(ip1 != -1)
	{
	newgradient[ip1*2] += ((2.0)*(L)*(y)*1.0/((((((L)*(L))*((((u0)+((-1.0)*(u2)))*((u0)+((-1.0)*(u2))))+(((v0)+((-1.0)*(v2)))*((v0)+((-1.0)*(v2))))))+((-2.0)*(L)*(((u0)*(u0))+((u1)*(u2))+((-1.0)*(u0)*((u1)+(u2)))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v2)))))*(x))+(((((u0)+((-1.0)*(u1)))*((u0)+((-1.0)*(u1))))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v1)))))*(((x)*(x))+((y)*(y))))+pow((((-4.0)*((L)*(L))*((((u2)*(((-1.0)*(v0))+(v1)))+((u1)*((v0)+((-1.0)*(v2))))+((u0)*(((-1.0)*(v1))+(v2))))*(((u2)*(((-1.0)*(v0))+(v1)))+((u1)*((v0)+((-1.0)*(v2))))+((u0)*(((-1.0)*(v1))+(v2)))))*((y)*(y)))+(((((L)*(L))*((((u0)+((-1.0)*(u2)))*((u0)+((-1.0)*(u2))))+(((v0)+((-1.0)*(v2)))*((v0)+((-1.0)*(v2))))))+((-2.0)*(L)*(((u0)*(u0))+((u1)*(u2))+((-1.0)*(u0)*((u1)+(u2)))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v2)))))*(x))+(((((u0)+((-1.0)*(u1)))*((u0)+((-1.0)*(u1))))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v1)))))*(((x)*(x))+((y)*(y)))))*((((L)*(L))*((((u0)+((-1.0)*(u2)))*((u0)+((-1.0)*(u2))))+(((v0)+((-1.0)*(v2)))*((v0)+((-1.0)*(v2))))))+((-2.0)*(L)*(((u0)*(u0))+((u1)*(u2))+((-1.0)*(u0)*((u1)+(u2)))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v2)))))*(x))+(((((u0)+((-1.0)*(u1)))*((u0)+((-1.0)*(u1))))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v1)))))*(((x)*(x))+((y)*(y))))))),(1.0)/(2.0)))*((((L)*(L))*((((u0)+((-1.0)*(u2)))*((u0)+((-1.0)*(u2))))+(((v0)+((-1.0)*(v2)))*((v0)+((-1.0)*(v2))))))+((-2.0)*(L)*(((u0)*(u0))+((u1)*(u2))+((-1.0)*(u0)*((u1)+(u2)))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v2)))))*(x))+(((((u0)+((-1.0)*(u1)))*((u0)+((-1.0)*(u1))))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v1)))))*(((x)*(x))+((y)*(y))))+pow((((-4.0)*((L)*(L))*((((u2)*(((-1.0)*(v0))+(v1)))+((u1)*((v0)+((-1.0)*(v2))))+((u0)*(((-1.0)*(v1))+(v2))))*(((u2)*(((-1.0)*(v0))+(v1)))+((u1)*((v0)+((-1.0)*(v2))))+((u0)*(((-1.0)*(v1))+(v2)))))*((y)*(y)))+(((((L)*(L))*((((u0)+((-1.0)*(u2)))*((u0)+((-1.0)*(u2))))+(((v0)+((-1.0)*(v2)))*((v0)+((-1.0)*(v2))))))+((-2.0)*(L)*(((u0)*(u0))+((u1)*(u2))+((-1.0)*(u0)*((u1)+(u2)))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v2)))))*(x))+(((((u0)+((-1.0)*(u1)))*((u0)+((-1.0)*(u1))))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v1)))))*(((x)*(x))+((y)*(y)))))*((((L)*(L))*((((u0)+((-1.0)*(u2)))*((u0)+((-1.0)*(u2))))+(((v0)+((-1.0)*(v2)))*((v0)+((-1.0)*(v2))))))+((-2.0)*(L)*(((u0)*(u0))+((u1)*(u2))+((-1.0)*(u0)*((u1)+(u2)))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v2)))))*(x))+(((((u0)+((-1.0)*(u1)))*((u0)+((-1.0)*(u1))))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v1)))))*(((x)*(x))+((y)*(y))))))),(1.0)/(2.0)))))*(((-1.0)*(((((u2)*(((-1.0)*(v0))+(v1)))+((u1)*((v0)+((-1.0)*(v2))))+((u0)*(((-1.0)*(v1))+(v2))))*(((u2)*(((-1.0)*(v0))+(v1)))+((u1)*((v0)+((-1.0)*(v2))))+((u0)*(((-1.0)*(v1))+(v2)))))+(((L)*(L))*((y)*(y))))*(((2.0)*(L)*((u0)+((-1.0)*(u2)))*(x))+((-2.0)*((u0)+((-1.0)*(u1)))*(((x)*(x))+((y)*(y))))+((1.0)/(2.0)*(((8.0)*((L)*(L))*((v0)+((-1.0)*(v2)))*(((u2)*((v0)+((-1.0)*(v1))))+((u0)*((v1)+((-1.0)*(v2))))+((u1)*(((-1.0)*(v0))+(v2))))*((y)*(y)))+((2.0)*(((2.0)*(L)*((u0)+((-1.0)*(u2)))*(x))+((-2.0)*((u0)+((-1.0)*(u1)))*(((x)*(x))+((y)*(y)))))*((((L)*(L))*((((u0)+((-1.0)*(u2)))*((u0)+((-1.0)*(u2))))+(((v0)+((-1.0)*(v2)))*((v0)+((-1.0)*(v2))))))+((-2.0)*(L)*(((u0)*(u0))+((u1)*(u2))+((-1.0)*(u0)*((u1)+(u2)))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v2)))))*(x))+(((((u0)+((-1.0)*(u1)))*((u0)+((-1.0)*(u1))))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v1)))))*(((x)*(x))+((y)*(y)))))))*pow((((-4.0)*((L)*(L))*((((u2)*(((-1.0)*(v0))+(v1)))+((u1)*((v0)+((-1.0)*(v2))))+((u0)*(((-1.0)*(v1))+(v2))))*(((u2)*(((-1.0)*(v0))+(v1)))+((u1)*((v0)+((-1.0)*(v2))))+((u0)*(((-1.0)*(v1))+(v2)))))*((y)*(y)))+(((((L)*(L))*((((u0)+((-1.0)*(u2)))*((u0)+((-1.0)*(u2))))+(((v0)+((-1.0)*(v2)))*((v0)+((-1.0)*(v2))))))+((-2.0)*(L)*(((u0)*(u0))+((u1)*(u2))+((-1.0)*(u0)*((u1)+(u2)))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v2)))))*(x))+(((((u0)+((-1.0)*(u1)))*((u0)+((-1.0)*(u1))))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v1)))))*(((x)*(x))+((y)*(y)))))*((((L)*(L))*((((u0)+((-1.0)*(u2)))*((u0)+((-1.0)*(u2))))+(((v0)+((-1.0)*(v2)))*((v0)+((-1.0)*(v2))))))+((-2.0)*(L)*(((u0)*(u0))+((u1)*(u2))+((-1.0)*(u0)*((u1)+(u2)))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v2)))))*(x))+(((((u0)+((-1.0)*(u1)))*((u0)+((-1.0)*(u1))))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v1)))))*(((x)*(x))+((y)*(y))))))),(-1.0)/(2.0)))))+((2.0)*((v0)+((-1.0)*(v2)))*(((u2)*(((-1.0)*(v0))+(v1)))+((u1)*((v0)+((-1.0)*(v2))))+((u0)*(((-1.0)*(v1))+(v2))))*((((L)*(L))*((((u0)+((-1.0)*(u2)))*((u0)+((-1.0)*(u2))))+(((v0)+((-1.0)*(v2)))*((v0)+((-1.0)*(v2))))))+((-2.0)*(L)*(((u0)*(u0))+((u1)*(u2))+((-1.0)*(u0)*((u1)+(u2)))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v2)))))*(x))+(((((u0)+((-1.0)*(u1)))*((u0)+((-1.0)*(u1))))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v1)))))*(((x)*(x))+((y)*(y))))+pow((((-4.0)*((L)*(L))*((((u2)*(((-1.0)*(v0))+(v1)))+((u1)*((v0)+((-1.0)*(v2))))+((u0)*(((-1.0)*(v1))+(v2))))*(((u2)*(((-1.0)*(v0))+(v1)))+((u1)*((v0)+((-1.0)*(v2))))+((u0)*(((-1.0)*(v1))+(v2)))))*((y)*(y)))+(((((L)*(L))*((((u0)+((-1.0)*(u2)))*((u0)+((-1.0)*(u2))))+(((v0)+((-1.0)*(v2)))*((v0)+((-1.0)*(v2))))))+((-2.0)*(L)*(((u0)*(u0))+((u1)*(u2))+((-1.0)*(u0)*((u1)+(u2)))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v2)))))*(x))+(((((u0)+((-1.0)*(u1)))*((u0)+((-1.0)*(u1))))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v1)))))*(((x)*(x))+((y)*(y)))))*((((L)*(L))*((((u0)+((-1.0)*(u2)))*((u0)+((-1.0)*(u2))))+(((v0)+((-1.0)*(v2)))*((v0)+((-1.0)*(v2))))))+((-2.0)*(L)*(((u0)*(u0))+((u1)*(u2))+((-1.0)*(u0)*((u1)+(u2)))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v2)))))*(x))+(((((u0)+((-1.0)*(u1)))*((u0)+((-1.0)*(u1))))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v1)))))*(((x)*(x))+((y)*(y))))))),(1.0)/(2.0))))));
	newgradient[ip1*2+1] += ((2.0)*(L)*(y)*1.0/((((((L)*(L))*((((u0)+((-1.0)*(u2)))*((u0)+((-1.0)*(u2))))+(((v0)+((-1.0)*(v2)))*((v0)+((-1.0)*(v2))))))+((-2.0)*(L)*(((u0)*(u0))+((u1)*(u2))+((-1.0)*(u0)*((u1)+(u2)))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v2)))))*(x))+(((((u0)+((-1.0)*(u1)))*((u0)+((-1.0)*(u1))))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v1)))))*(((x)*(x))+((y)*(y))))+pow((((-4.0)*((L)*(L))*((((u2)*(((-1.0)*(v0))+(v1)))+((u1)*((v0)+((-1.0)*(v2))))+((u0)*(((-1.0)*(v1))+(v2))))*(((u2)*(((-1.0)*(v0))+(v1)))+((u1)*((v0)+((-1.0)*(v2))))+((u0)*(((-1.0)*(v1))+(v2)))))*((y)*(y)))+(((((L)*(L))*((((u0)+((-1.0)*(u2)))*((u0)+((-1.0)*(u2))))+(((v0)+((-1.0)*(v2)))*((v0)+((-1.0)*(v2))))))+((-2.0)*(L)*(((u0)*(u0))+((u1)*(u2))+((-1.0)*(u0)*((u1)+(u2)))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v2)))))*(x))+(((((u0)+((-1.0)*(u1)))*((u0)+((-1.0)*(u1))))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v1)))))*(((x)*(x))+((y)*(y)))))*((((L)*(L))*((((u0)+((-1.0)*(u2)))*((u0)+((-1.0)*(u2))))+(((v0)+((-1.0)*(v2)))*((v0)+((-1.0)*(v2))))))+((-2.0)*(L)*(((u0)*(u0))+((u1)*(u2))+((-1.0)*(u0)*((u1)+(u2)))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v2)))))*(x))+(((((u0)+((-1.0)*(u1)))*((u0)+((-1.0)*(u1))))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v1)))))*(((x)*(x))+((y)*(y))))))),(1.0)/(2.0)))*((((L)*(L))*((((u0)+((-1.0)*(u2)))*((u0)+((-1.0)*(u2))))+(((v0)+((-1.0)*(v2)))*((v0)+((-1.0)*(v2))))))+((-2.0)*(L)*(((u0)*(u0))+((u1)*(u2))+((-1.0)*(u0)*((u1)+(u2)))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v2)))))*(x))+(((((u0)+((-1.0)*(u1)))*((u0)+((-1.0)*(u1))))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v1)))))*(((x)*(x))+((y)*(y))))+pow((((-4.0)*((L)*(L))*((((u2)*(((-1.0)*(v0))+(v1)))+((u1)*((v0)+((-1.0)*(v2))))+((u0)*(((-1.0)*(v1))+(v2))))*(((u2)*(((-1.0)*(v0))+(v1)))+((u1)*((v0)+((-1.0)*(v2))))+((u0)*(((-1.0)*(v1))+(v2)))))*((y)*(y)))+(((((L)*(L))*((((u0)+((-1.0)*(u2)))*((u0)+((-1.0)*(u2))))+(((v0)+((-1.0)*(v2)))*((v0)+((-1.0)*(v2))))))+((-2.0)*(L)*(((u0)*(u0))+((u1)*(u2))+((-1.0)*(u0)*((u1)+(u2)))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v2)))))*(x))+(((((u0)+((-1.0)*(u1)))*((u0)+((-1.0)*(u1))))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v1)))))*(((x)*(x))+((y)*(y)))))*((((L)*(L))*((((u0)+((-1.0)*(u2)))*((u0)+((-1.0)*(u2))))+(((v0)+((-1.0)*(v2)))*((v0)+((-1.0)*(v2))))))+((-2.0)*(L)*(((u0)*(u0))+((u1)*(u2))+((-1.0)*(u0)*((u1)+(u2)))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v2)))))*(x))+(((((u0)+((-1.0)*(u1)))*((u0)+((-1.0)*(u1))))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v1)))))*(((x)*(x))+((y)*(y))))))),(1.0)/(2.0)))))*(((2.0)*(((-1.0)*(u0))+(u2))*(((u2)*(((-1.0)*(v0))+(v1)))+((u1)*((v0)+((-1.0)*(v2))))+((u0)*(((-1.0)*(v1))+(v2))))*((((L)*(L))*((((u0)+((-1.0)*(u2)))*((u0)+((-1.0)*(u2))))+(((v0)+((-1.0)*(v2)))*((v0)+((-1.0)*(v2))))))+((-2.0)*(L)*(((u0)*(u0))+((u1)*(u2))+((-1.0)*(u0)*((u1)+(u2)))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v2)))))*(x))+(((((u0)+((-1.0)*(u1)))*((u0)+((-1.0)*(u1))))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v1)))))*(((x)*(x))+((y)*(y))))+pow((((-4.0)*((L)*(L))*((((u2)*(((-1.0)*(v0))+(v1)))+((u1)*((v0)+((-1.0)*(v2))))+((u0)*(((-1.0)*(v1))+(v2))))*(((u2)*(((-1.0)*(v0))+(v1)))+((u1)*((v0)+((-1.0)*(v2))))+((u0)*(((-1.0)*(v1))+(v2)))))*((y)*(y)))+(((((L)*(L))*((((u0)+((-1.0)*(u2)))*((u0)+((-1.0)*(u2))))+(((v0)+((-1.0)*(v2)))*((v0)+((-1.0)*(v2))))))+((-2.0)*(L)*(((u0)*(u0))+((u1)*(u2))+((-1.0)*(u0)*((u1)+(u2)))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v2)))))*(x))+(((((u0)+((-1.0)*(u1)))*((u0)+((-1.0)*(u1))))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v1)))))*(((x)*(x))+((y)*(y)))))*((((L)*(L))*((((u0)+((-1.0)*(u2)))*((u0)+((-1.0)*(u2))))+(((v0)+((-1.0)*(v2)))*((v0)+((-1.0)*(v2))))))+((-2.0)*(L)*(((u0)*(u0))+((u1)*(u2))+((-1.0)*(u0)*((u1)+(u2)))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v2)))))*(x))+(((((u0)+((-1.0)*(u1)))*((u0)+((-1.0)*(u1))))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v1)))))*(((x)*(x))+((y)*(y))))))),(1.0)/(2.0))))+((-1.0)*(((((u2)*(((-1.0)*(v0))+(v1)))+((u1)*((v0)+((-1.0)*(v2))))+((u0)*(((-1.0)*(v1))+(v2))))*(((u2)*(((-1.0)*(v0))+(v1)))+((u1)*((v0)+((-1.0)*(v2))))+((u0)*(((-1.0)*(v1))+(v2)))))+(((L)*(L))*((y)*(y))))*(((2.0)*(L)*((v0)+((-1.0)*(v2)))*(x))+((-2.0)*((v0)+((-1.0)*(v1)))*(((x)*(x))+((y)*(y))))+((1.0)/(2.0)*pow((((-4.0)*((L)*(L))*((((u2)*(((-1.0)*(v0))+(v1)))+((u1)*((v0)+((-1.0)*(v2))))+((u0)*(((-1.0)*(v1))+(v2))))*(((u2)*(((-1.0)*(v0))+(v1)))+((u1)*((v0)+((-1.0)*(v2))))+((u0)*(((-1.0)*(v1))+(v2)))))*((y)*(y)))+(((((L)*(L))*((((u0)+((-1.0)*(u2)))*((u0)+((-1.0)*(u2))))+(((v0)+((-1.0)*(v2)))*((v0)+((-1.0)*(v2))))))+((-2.0)*(L)*(((u0)*(u0))+((u1)*(u2))+((-1.0)*(u0)*((u1)+(u2)))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v2)))))*(x))+(((((u0)+((-1.0)*(u1)))*((u0)+((-1.0)*(u1))))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v1)))))*(((x)*(x))+((y)*(y)))))*((((L)*(L))*((((u0)+((-1.0)*(u2)))*((u0)+((-1.0)*(u2))))+(((v0)+((-1.0)*(v2)))*((v0)+((-1.0)*(v2))))))+((-2.0)*(L)*(((u0)*(u0))+((u1)*(u2))+((-1.0)*(u0)*((u1)+(u2)))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v2)))))*(x))+(((((u0)+((-1.0)*(u1)))*((u0)+((-1.0)*(u1))))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v1)))))*(((x)*(x))+((y)*(y))))))),(-1.0)/(2.0))*(((-8.0)*((L)*(L))*((u0)+((-1.0)*(u2)))*(((u2)*((v0)+((-1.0)*(v1))))+((u0)*((v1)+((-1.0)*(v2))))+((u1)*(((-1.0)*(v0))+(v2))))*((y)*(y)))+((2.0)*((((L)*(L))*((((u0)+((-1.0)*(u2)))*((u0)+((-1.0)*(u2))))+(((v0)+((-1.0)*(v2)))*((v0)+((-1.0)*(v2))))))+((-2.0)*(L)*(((u0)*(u0))+((u1)*(u2))+((-1.0)*(u0)*((u1)+(u2)))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v2)))))*(x))+(((((u0)+((-1.0)*(u1)))*((u0)+((-1.0)*(u1))))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v1)))))*(((x)*(x))+((y)*(y)))))*(((2.0)*(L)*((v0)+((-1.0)*(v2)))*(x))+((-2.0)*((v0)+((-1.0)*(v1)))*(((x)*(x))+((y)*(y))))))))))));
	}

	if(j != -1)
	{
	newgradient[j*2] += ((2.0)*(L)*(y)*1.0/((((((L)*(L))*((((u0)+((-1.0)*(u2)))*((u0)+((-1.0)*(u2))))+(((v0)+((-1.0)*(v2)))*((v0)+((-1.0)*(v2))))))+((-2.0)*(L)*(((u0)*(u0))+((u1)*(u2))+((-1.0)*(u0)*((u1)+(u2)))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v2)))))*(x))+(((((u0)+((-1.0)*(u1)))*((u0)+((-1.0)*(u1))))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v1)))))*(((x)*(x))+((y)*(y))))+pow((((-4.0)*((L)*(L))*((((u2)*(((-1.0)*(v0))+(v1)))+((u1)*((v0)+((-1.0)*(v2))))+((u0)*(((-1.0)*(v1))+(v2))))*(((u2)*(((-1.0)*(v0))+(v1)))+((u1)*((v0)+((-1.0)*(v2))))+((u0)*(((-1.0)*(v1))+(v2)))))*((y)*(y)))+(((((L)*(L))*((((u0)+((-1.0)*(u2)))*((u0)+((-1.0)*(u2))))+(((v0)+((-1.0)*(v2)))*((v0)+((-1.0)*(v2))))))+((-2.0)*(L)*(((u0)*(u0))+((u1)*(u2))+((-1.0)*(u0)*((u1)+(u2)))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v2)))))*(x))+(((((u0)+((-1.0)*(u1)))*((u0)+((-1.0)*(u1))))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v1)))))*(((x)*(x))+((y)*(y)))))*((((L)*(L))*((((u0)+((-1.0)*(u2)))*((u0)+((-1.0)*(u2))))+(((v0)+((-1.0)*(v2)))*((v0)+((-1.0)*(v2))))))+((-2.0)*(L)*(((u0)*(u0))+((u1)*(u2))+((-1.0)*(u0)*((u1)+(u2)))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v2)))))*(x))+(((((u0)+((-1.0)*(u1)))*((u0)+((-1.0)*(u1))))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v1)))))*(((x)*(x))+((y)*(y))))))),(1.0)/(2.0)))*((((L)*(L))*((((u0)+((-1.0)*(u2)))*((u0)+((-1.0)*(u2))))+(((v0)+((-1.0)*(v2)))*((v0)+((-1.0)*(v2))))))+((-2.0)*(L)*(((u0)*(u0))+((u1)*(u2))+((-1.0)*(u0)*((u1)+(u2)))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v2)))))*(x))+(((((u0)+((-1.0)*(u1)))*((u0)+((-1.0)*(u1))))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v1)))))*(((x)*(x))+((y)*(y))))+pow((((-4.0)*((L)*(L))*((((u2)*(((-1.0)*(v0))+(v1)))+((u1)*((v0)+((-1.0)*(v2))))+((u0)*(((-1.0)*(v1))+(v2))))*(((u2)*(((-1.0)*(v0))+(v1)))+((u1)*((v0)+((-1.0)*(v2))))+((u0)*(((-1.0)*(v1))+(v2)))))*((y)*(y)))+(((((L)*(L))*((((u0)+((-1.0)*(u2)))*((u0)+((-1.0)*(u2))))+(((v0)+((-1.0)*(v2)))*((v0)+((-1.0)*(v2))))))+((-2.0)*(L)*(((u0)*(u0))+((u1)*(u2))+((-1.0)*(u0)*((u1)+(u2)))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v2)))))*(x))+(((((u0)+((-1.0)*(u1)))*((u0)+((-1.0)*(u1))))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v1)))))*(((x)*(x))+((y)*(y)))))*((((L)*(L))*((((u0)+((-1.0)*(u2)))*((u0)+((-1.0)*(u2))))+(((v0)+((-1.0)*(v2)))*((v0)+((-1.0)*(v2))))))+((-2.0)*(L)*(((u0)*(u0))+((u1)*(u2))+((-1.0)*(u0)*((u1)+(u2)))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v2)))))*(x))+(((((u0)+((-1.0)*(u1)))*((u0)+((-1.0)*(u1))))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v1)))))*(((x)*(x))+((y)*(y))))))),(1.0)/(2.0)))))*(((-1.0)*(((((u2)*(((-1.0)*(v0))+(v1)))+((u1)*((v0)+((-1.0)*(v2))))+((u0)*(((-1.0)*(v1))+(v2))))*(((u2)*(((-1.0)*(v0))+(v1)))+((u1)*((v0)+((-1.0)*(v2))))+((u0)*(((-1.0)*(v1))+(v2)))))+(((L)*(L))*((y)*(y))))*(((-2.0)*((L)*(L))*((u0)+((-1.0)*(u2))))+((2.0)*(L)*((u0)+((-1.0)*(u1)))*(x))+((1.0)/(2.0)*(((8.0)*((L)*(L))*((v0)+((-1.0)*(v1)))*(((u2)*(((-1.0)*(v0))+(v1)))+((u1)*((v0)+((-1.0)*(v2))))+((u0)*(((-1.0)*(v1))+(v2))))*((y)*(y)))+((-4.0)*(L)*(((L)*((u0)+((-1.0)*(u2))))+((((-1.0)*(u0))+(u1))*(x)))*((((L)*(L))*((((u0)+((-1.0)*(u2)))*((u0)+((-1.0)*(u2))))+(((v0)+((-1.0)*(v2)))*((v0)+((-1.0)*(v2))))))+((-2.0)*(L)*(((u0)*(u0))+((u1)*(u2))+((-1.0)*(u0)*((u1)+(u2)))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v2)))))*(x))+(((((u0)+((-1.0)*(u1)))*((u0)+((-1.0)*(u1))))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v1)))))*(((x)*(x))+((y)*(y)))))))*pow((((-4.0)*((L)*(L))*((((u2)*(((-1.0)*(v0))+(v1)))+((u1)*((v0)+((-1.0)*(v2))))+((u0)*(((-1.0)*(v1))+(v2))))*(((u2)*(((-1.0)*(v0))+(v1)))+((u1)*((v0)+((-1.0)*(v2))))+((u0)*(((-1.0)*(v1))+(v2)))))*((y)*(y)))+(((((L)*(L))*((((u0)+((-1.0)*(u2)))*((u0)+((-1.0)*(u2))))+(((v0)+((-1.0)*(v2)))*((v0)+((-1.0)*(v2))))))+((-2.0)*(L)*(((u0)*(u0))+((u1)*(u2))+((-1.0)*(u0)*((u1)+(u2)))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v2)))))*(x))+(((((u0)+((-1.0)*(u1)))*((u0)+((-1.0)*(u1))))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v1)))))*(((x)*(x))+((y)*(y)))))*((((L)*(L))*((((u0)+((-1.0)*(u2)))*((u0)+((-1.0)*(u2))))+(((v0)+((-1.0)*(v2)))*((v0)+((-1.0)*(v2))))))+((-2.0)*(L)*(((u0)*(u0))+((u1)*(u2))+((-1.0)*(u0)*((u1)+(u2)))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v2)))))*(x))+(((((u0)+((-1.0)*(u1)))*((u0)+((-1.0)*(u1))))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v1)))))*(((x)*(x))+((y)*(y))))))),(-1.0)/(2.0)))))+((2.0)*(((-1.0)*(v0))+(v1))*(((u2)*(((-1.0)*(v0))+(v1)))+((u1)*((v0)+((-1.0)*(v2))))+((u0)*(((-1.0)*(v1))+(v2))))*((((L)*(L))*((((u0)+((-1.0)*(u2)))*((u0)+((-1.0)*(u2))))+(((v0)+((-1.0)*(v2)))*((v0)+((-1.0)*(v2))))))+((-2.0)*(L)*(((u0)*(u0))+((u1)*(u2))+((-1.0)*(u0)*((u1)+(u2)))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v2)))))*(x))+(((((u0)+((-1.0)*(u1)))*((u0)+((-1.0)*(u1))))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v1)))))*(((x)*(x))+((y)*(y))))+pow((((-4.0)*((L)*(L))*((((u2)*(((-1.0)*(v0))+(v1)))+((u1)*((v0)+((-1.0)*(v2))))+((u0)*(((-1.0)*(v1))+(v2))))*(((u2)*(((-1.0)*(v0))+(v1)))+((u1)*((v0)+((-1.0)*(v2))))+((u0)*(((-1.0)*(v1))+(v2)))))*((y)*(y)))+(((((L)*(L))*((((u0)+((-1.0)*(u2)))*((u0)+((-1.0)*(u2))))+(((v0)+((-1.0)*(v2)))*((v0)+((-1.0)*(v2))))))+((-2.0)*(L)*(((u0)*(u0))+((u1)*(u2))+((-1.0)*(u0)*((u1)+(u2)))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v2)))))*(x))+(((((u0)+((-1.0)*(u1)))*((u0)+((-1.0)*(u1))))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v1)))))*(((x)*(x))+((y)*(y)))))*((((L)*(L))*((((u0)+((-1.0)*(u2)))*((u0)+((-1.0)*(u2))))+(((v0)+((-1.0)*(v2)))*((v0)+((-1.0)*(v2))))))+((-2.0)*(L)*(((u0)*(u0))+((u1)*(u2))+((-1.0)*(u0)*((u1)+(u2)))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v2)))))*(x))+(((((u0)+((-1.0)*(u1)))*((u0)+((-1.0)*(u1))))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v1)))))*(((x)*(x))+((y)*(y))))))),(1.0)/(2.0))))));
	newgradient[j*2+1] += ((2.0)*(L)*(y)*1.0/((((((L)*(L))*((((u0)+((-1.0)*(u2)))*((u0)+((-1.0)*(u2))))+(((v0)+((-1.0)*(v2)))*((v0)+((-1.0)*(v2))))))+((-2.0)*(L)*(((u0)*(u0))+((u1)*(u2))+((-1.0)*(u0)*((u1)+(u2)))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v2)))))*(x))+(((((u0)+((-1.0)*(u1)))*((u0)+((-1.0)*(u1))))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v1)))))*(((x)*(x))+((y)*(y))))+pow((((-4.0)*((L)*(L))*((((u2)*(((-1.0)*(v0))+(v1)))+((u1)*((v0)+((-1.0)*(v2))))+((u0)*(((-1.0)*(v1))+(v2))))*(((u2)*(((-1.0)*(v0))+(v1)))+((u1)*((v0)+((-1.0)*(v2))))+((u0)*(((-1.0)*(v1))+(v2)))))*((y)*(y)))+(((((L)*(L))*((((u0)+((-1.0)*(u2)))*((u0)+((-1.0)*(u2))))+(((v0)+((-1.0)*(v2)))*((v0)+((-1.0)*(v2))))))+((-2.0)*(L)*(((u0)*(u0))+((u1)*(u2))+((-1.0)*(u0)*((u1)+(u2)))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v2)))))*(x))+(((((u0)+((-1.0)*(u1)))*((u0)+((-1.0)*(u1))))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v1)))))*(((x)*(x))+((y)*(y)))))*((((L)*(L))*((((u0)+((-1.0)*(u2)))*((u0)+((-1.0)*(u2))))+(((v0)+((-1.0)*(v2)))*((v0)+((-1.0)*(v2))))))+((-2.0)*(L)*(((u0)*(u0))+((u1)*(u2))+((-1.0)*(u0)*((u1)+(u2)))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v2)))))*(x))+(((((u0)+((-1.0)*(u1)))*((u0)+((-1.0)*(u1))))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v1)))))*(((x)*(x))+((y)*(y))))))),(1.0)/(2.0)))*((((L)*(L))*((((u0)+((-1.0)*(u2)))*((u0)+((-1.0)*(u2))))+(((v0)+((-1.0)*(v2)))*((v0)+((-1.0)*(v2))))))+((-2.0)*(L)*(((u0)*(u0))+((u1)*(u2))+((-1.0)*(u0)*((u1)+(u2)))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v2)))))*(x))+(((((u0)+((-1.0)*(u1)))*((u0)+((-1.0)*(u1))))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v1)))))*(((x)*(x))+((y)*(y))))+pow((((-4.0)*((L)*(L))*((((u2)*(((-1.0)*(v0))+(v1)))+((u1)*((v0)+((-1.0)*(v2))))+((u0)*(((-1.0)*(v1))+(v2))))*(((u2)*(((-1.0)*(v0))+(v1)))+((u1)*((v0)+((-1.0)*(v2))))+((u0)*(((-1.0)*(v1))+(v2)))))*((y)*(y)))+(((((L)*(L))*((((u0)+((-1.0)*(u2)))*((u0)+((-1.0)*(u2))))+(((v0)+((-1.0)*(v2)))*((v0)+((-1.0)*(v2))))))+((-2.0)*(L)*(((u0)*(u0))+((u1)*(u2))+((-1.0)*(u0)*((u1)+(u2)))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v2)))))*(x))+(((((u0)+((-1.0)*(u1)))*((u0)+((-1.0)*(u1))))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v1)))))*(((x)*(x))+((y)*(y)))))*((((L)*(L))*((((u0)+((-1.0)*(u2)))*((u0)+((-1.0)*(u2))))+(((v0)+((-1.0)*(v2)))*((v0)+((-1.0)*(v2))))))+((-2.0)*(L)*(((u0)*(u0))+((u1)*(u2))+((-1.0)*(u0)*((u1)+(u2)))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v2)))))*(x))+(((((u0)+((-1.0)*(u1)))*((u0)+((-1.0)*(u1))))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v1)))))*(((x)*(x))+((y)*(y))))))),(1.0)/(2.0)))))*(((-1.0)*(((((u2)*(((-1.0)*(v0))+(v1)))+((u1)*((v0)+((-1.0)*(v2))))+((u0)*(((-1.0)*(v1))+(v2))))*(((u2)*(((-1.0)*(v0))+(v1)))+((u1)*((v0)+((-1.0)*(v2))))+((u0)*(((-1.0)*(v1))+(v2)))))+(((L)*(L))*((y)*(y))))*(((-2.0)*((L)*(L))*((v0)+((-1.0)*(v2))))+((2.0)*(L)*((v0)+((-1.0)*(v1)))*(x))+((1.0)/(2.0)*(((8.0)*((L)*(L))*((u0)+((-1.0)*(u1)))*(((u2)*((v0)+((-1.0)*(v1))))+((u0)*((v1)+((-1.0)*(v2))))+((u1)*(((-1.0)*(v0))+(v2))))*((y)*(y)))+((-4.0)*(L)*(((L)*((v0)+((-1.0)*(v2))))+((((-1.0)*(v0))+(v1))*(x)))*((((L)*(L))*((((u0)+((-1.0)*(u2)))*((u0)+((-1.0)*(u2))))+(((v0)+((-1.0)*(v2)))*((v0)+((-1.0)*(v2))))))+((-2.0)*(L)*(((u0)*(u0))+((u1)*(u2))+((-1.0)*(u0)*((u1)+(u2)))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v2)))))*(x))+(((((u0)+((-1.0)*(u1)))*((u0)+((-1.0)*(u1))))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v1)))))*(((x)*(x))+((y)*(y)))))))*pow((((-4.0)*((L)*(L))*((((u2)*(((-1.0)*(v0))+(v1)))+((u1)*((v0)+((-1.0)*(v2))))+((u0)*(((-1.0)*(v1))+(v2))))*(((u2)*(((-1.0)*(v0))+(v1)))+((u1)*((v0)+((-1.0)*(v2))))+((u0)*(((-1.0)*(v1))+(v2)))))*((y)*(y)))+(((((L)*(L))*((((u0)+((-1.0)*(u2)))*((u0)+((-1.0)*(u2))))+(((v0)+((-1.0)*(v2)))*((v0)+((-1.0)*(v2))))))+((-2.0)*(L)*(((u0)*(u0))+((u1)*(u2))+((-1.0)*(u0)*((u1)+(u2)))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v2)))))*(x))+(((((u0)+((-1.0)*(u1)))*((u0)+((-1.0)*(u1))))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v1)))))*(((x)*(x))+((y)*(y)))))*((((L)*(L))*((((u0)+((-1.0)*(u2)))*((u0)+((-1.0)*(u2))))+(((v0)+((-1.0)*(v2)))*((v0)+((-1.0)*(v2))))))+((-2.0)*(L)*(((u0)*(u0))+((u1)*(u2))+((-1.0)*(u0)*((u1)+(u2)))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v2)))))*(x))+(((((u0)+((-1.0)*(u1)))*((u0)+((-1.0)*(u1))))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v1)))))*(((x)*(x))+((y)*(y))))))),(-1.0)/(2.0)))))+((2.0)*((u0)+((-1.0)*(u1)))*(((u2)*(((-1.0)*(v0))+(v1)))+((u1)*((v0)+((-1.0)*(v2))))+((u0)*(((-1.0)*(v1))+(v2))))*((((L)*(L))*((((u0)+((-1.0)*(u2)))*((u0)+((-1.0)*(u2))))+(((v0)+((-1.0)*(v2)))*((v0)+((-1.0)*(v2))))))+((-2.0)*(L)*(((u0)*(u0))+((u1)*(u2))+((-1.0)*(u0)*((u1)+(u2)))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v2)))))*(x))+(((((u0)+((-1.0)*(u1)))*((u0)+((-1.0)*(u1))))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v1)))))*(((x)*(x))+((y)*(y))))+pow((((-4.0)*((L)*(L))*((((u2)*(((-1.0)*(v0))+(v1)))+((u1)*((v0)+((-1.0)*(v2))))+((u0)*(((-1.0)*(v1))+(v2))))*(((u2)*(((-1.0)*(v0))+(v1)))+((u1)*((v0)+((-1.0)*(v2))))+((u0)*(((-1.0)*(v1))+(v2)))))*((y)*(y)))+(((((L)*(L))*((((u0)+((-1.0)*(u2)))*((u0)+((-1.0)*(u2))))+(((v0)+((-1.0)*(v2)))*((v0)+((-1.0)*(v2))))))+((-2.0)*(L)*(((u0)*(u0))+((u1)*(u2))+((-1.0)*(u0)*((u1)+(u2)))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v2)))))*(x))+(((((u0)+((-1.0)*(u1)))*((u0)+((-1.0)*(u1))))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v1)))))*(((x)*(x))+((y)*(y)))))*((((L)*(L))*((((u0)+((-1.0)*(u2)))*((u0)+((-1.0)*(u2))))+(((v0)+((-1.0)*(v2)))*((v0)+((-1.0)*(v2))))))+((-2.0)*(L)*(((u0)*(u0))+((u1)*(u2))+((-1.0)*(u0)*((u1)+(u2)))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v2)))))*(x))+(((((u0)+((-1.0)*(u1)))*((u0)+((-1.0)*(u1))))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v1)))))*(((x)*(x))+((y)*(y))))))),(1.0)/(2.0))))));
	}
}


double yaron_function_tri_sqrt_int(double L, double x, double y, double u0, double v0, double u1, double v1, double u2, double v2)
{
	return ((2.0)*pow((1.0 / (((L)))*1.0 / (((y)))*(((((u1)*(v0)) + ((-1.0)*(u2)*(v0)) + ((-1.0)*(u0)*(v1)) + ((u2)*(v1)) + ((u0)*(v2)) + ((-1.0)*(u1)*(v2)))*(((u1)*(v0)) + ((-1.0)*(u2)*(v0)) + ((-1.0)*(u0)*(v1)) + ((u2)*(v1)) + ((u0)*(v2)) + ((-1.0)*(u1)*(v2)))) + (((L)*(L))*((y)*(y))))*1.0 / (((pow((1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))) + ((((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))))), (1.0) / (2.0)) + ((-1.0)*pow((1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))) + ((((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))))), (1.0) / (2.0))))*(pow((1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))) + ((((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))))), (1.0) / (2.0)) + ((-1.0)*pow((1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))) + ((((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))))), (1.0) / (2.0))))))), (1.0) / (2.0)));
}

void yaron_function_grad_sqrt_int(double *newgradient, double L, double x, double y, double u0, double v0, double u1, double v1, double u2, double v2, int i, int ip1, int j)
{
	newgradient[2 * i] += (pow((1.0 / (((L)))*1.0 / (((y)))*(((((u1)*(v0)) + ((-1.0)*(u2)*(v0)) + ((-1.0)*(u0)*(v1)) + ((u2)*(v1)) + ((u0)*(v2)) + ((-1.0)*(u1)*(v2)))*(((u1)*(v0)) + ((-1.0)*(u2)*(v0)) + ((-1.0)*(u0)*(v1)) + ((u2)*(v1)) + ((u0)*(v2)) + ((-1.0)*(u1)*(v2)))) + (((L)*(L))*((y)*(y))))*1.0 / (((pow((1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))) + ((((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))))), (1.0) / (2.0)) + ((-1.0)*pow((1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))) + ((((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))))), (1.0) / (2.0))))*(pow((1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))) + ((((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))))), (1.0) / (2.0)) + ((-1.0)*pow((1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))) + ((((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))))), (1.0) / (2.0))))))), (-1.0) / (2.0))*(((-2.0)*1.0 / (((L)))*1.0 / (((y)))*(((((u1)*(v0)) + ((-1.0)*(u2)*(v0)) + ((-1.0)*(u0)*(v1)) + ((u2)*(v1)) + ((u0)*(v2)) + ((-1.0)*(u1)*(v2)))*(((u1)*(v0)) + ((-1.0)*(u2)*(v0)) + ((-1.0)*(u0)*(v1)) + ((u2)*(v1)) + ((u0)*(v2)) + ((-1.0)*(u1)*(v2)))) + (((L)*(L))*((y)*(y))))*(((1.0) / (2.0)*1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((-2.0)*(y)*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))) + ((2.0)*((L)+((-1.0)*(x)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))))*pow((1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))) + ((((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))))), (-1.0) / (2.0))) + ((-1.0) / (2.0)*1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((2.0)*(y)*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))) + ((2.0)*((L)+((-1.0)*(x)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))))*pow((1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))) + ((((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))))), (-1.0) / (2.0))))*1.0 / (((pow((1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))) + ((((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))))), (1.0) / (2.0)) + ((-1.0)*pow((1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))) + ((((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))))), (1.0) / (2.0))))*(pow((1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))) + ((((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))))), (1.0) / (2.0)) + ((-1.0)*pow((1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))) + ((((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))))), (1.0) / (2.0))))*(pow((1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))) + ((((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))))), (1.0) / (2.0)) + ((-1.0)*pow((1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))) + ((((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))))), (1.0) / (2.0))))))) + ((2.0)*1.0 / (((L)))*(((-1.0)*(v1)) + (v2))*(((u1)*(v0)) + ((-1.0)*(u2)*(v0)) + ((-1.0)*(u0)*(v1)) + ((u2)*(v1)) + ((u0)*(v2)) + ((-1.0)*(u1)*(v2)))*1.0 / (((y)))*1.0 / (((pow((1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))) + ((((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))))), (1.0) / (2.0)) + ((-1.0)*pow((1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))) + ((((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))))), (1.0) / (2.0))))*(pow((1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))) + ((((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))))), (1.0) / (2.0)) + ((-1.0)*pow((1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))) + ((((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))))), (1.0) / (2.0)))))))));
	newgradient[2 * i + 1] += (pow((1.0 / (((L)))*1.0 / (((y)))*(((((u1)*(v0)) + ((-1.0)*(u2)*(v0)) + ((-1.0)*(u0)*(v1)) + ((u2)*(v1)) + ((u0)*(v2)) + ((-1.0)*(u1)*(v2)))*(((u1)*(v0)) + ((-1.0)*(u2)*(v0)) + ((-1.0)*(u0)*(v1)) + ((u2)*(v1)) + ((u0)*(v2)) + ((-1.0)*(u1)*(v2)))) + (((L)*(L))*((y)*(y))))*1.0 / (((pow((1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))) + ((((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))))), (1.0) / (2.0)) + ((-1.0)*pow((1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))) + ((((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))))), (1.0) / (2.0))))*(pow((1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))) + ((((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))))), (1.0) / (2.0)) + ((-1.0)*pow((1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))) + ((((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))))), (1.0) / (2.0))))))), (-1.0) / (2.0))*(((-2.0)*1.0 / (((L)))*1.0 / (((y)))*(((((u1)*(v0)) + ((-1.0)*(u2)*(v0)) + ((-1.0)*(u0)*(v1)) + ((u2)*(v1)) + ((u0)*(v2)) + ((-1.0)*(u1)*(v2)))*(((u1)*(v0)) + ((-1.0)*(u2)*(v0)) + ((-1.0)*(u0)*(v1)) + ((u2)*(v1)) + ((u0)*(v2)) + ((-1.0)*(u1)*(v2)))) + (((L)*(L))*((y)*(y))))*(((1.0) / (2.0)*1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((2.0)*((L)+((-1.0)*(x)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))) + ((2.0)*(y)*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))))*pow((1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))) + ((((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))))), (-1.0) / (2.0))) + ((-1.0) / (2.0)*1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((2.0)*((L)+((-1.0)*(x)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))) + ((-2.0)*(y)*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))))*pow((1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))) + ((((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))))), (-1.0) / (2.0))))*1.0 / (((pow((1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))) + ((((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))))), (1.0) / (2.0)) + ((-1.0)*pow((1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))) + ((((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))))), (1.0) / (2.0))))*(pow((1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))) + ((((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))))), (1.0) / (2.0)) + ((-1.0)*pow((1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))) + ((((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))))), (1.0) / (2.0))))*(pow((1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))) + ((((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))))), (1.0) / (2.0)) + ((-1.0)*pow((1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))) + ((((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))))), (1.0) / (2.0))))))) + ((2.0)*1.0 / (((L)))*((u1)+((-1.0)*(u2)))*(((u1)*(v0)) + ((-1.0)*(u2)*(v0)) + ((-1.0)*(u0)*(v1)) + ((u2)*(v1)) + ((u0)*(v2)) + ((-1.0)*(u1)*(v2)))*1.0 / (((y)))*1.0 / (((pow((1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))) + ((((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))))), (1.0) / (2.0)) + ((-1.0)*pow((1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))) + ((((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))))), (1.0) / (2.0))))*(pow((1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))) + ((((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))))), (1.0) / (2.0)) + ((-1.0)*pow((1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))) + ((((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))))), (1.0) / (2.0)))))))));

	newgradient[2 * ip1] += (pow((1.0 / (((L)))*1.0 / (((y)))*(((((u1)*(v0)) + ((-1.0)*(u2)*(v0)) + ((-1.0)*(u0)*(v1)) + ((u2)*(v1)) + ((u0)*(v2)) + ((-1.0)*(u1)*(v2)))*(((u1)*(v0)) + ((-1.0)*(u2)*(v0)) + ((-1.0)*(u0)*(v1)) + ((u2)*(v1)) + ((u0)*(v2)) + ((-1.0)*(u1)*(v2)))) + (((L)*(L))*((y)*(y))))*1.0 / (((pow((1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))) + ((((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))))), (1.0) / (2.0)) + ((-1.0)*pow((1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))) + ((((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))))), (1.0) / (2.0))))*(pow((1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))) + ((((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))))), (1.0) / (2.0)) + ((-1.0)*pow((1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))) + ((((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))))), (1.0) / (2.0))))))), (-1.0) / (2.0))*(((-2.0)*1.0 / (((L)))*1.0 / (((y)))*(((((u1)*(v0)) + ((-1.0)*(u2)*(v0)) + ((-1.0)*(u0)*(v1)) + ((u2)*(v1)) + ((u0)*(v2)) + ((-1.0)*(u1)*(v2)))*(((u1)*(v0)) + ((-1.0)*(u2)*(v0)) + ((-1.0)*(u0)*(v1)) + ((u2)*(v1)) + ((u0)*(v2)) + ((-1.0)*(u1)*(v2)))) + (((L)*(L))*((y)*(y))))*(((1.0) / (2.0)*1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((2.0)*(y)*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))) + ((2.0)*(x)*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))))*pow((1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))) + ((((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))))), (-1.0) / (2.0))) + ((-1.0) / (2.0)*1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((-2.0)*(y)*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))) + ((2.0)*(x)*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))))*pow((1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))) + ((((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))))), (-1.0) / (2.0))))*1.0 / (((pow((1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))) + ((((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))))), (1.0) / (2.0)) + ((-1.0)*pow((1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))) + ((((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))))), (1.0) / (2.0))))*(pow((1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))) + ((((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))))), (1.0) / (2.0)) + ((-1.0)*pow((1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))) + ((((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))))), (1.0) / (2.0))))*(pow((1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))) + ((((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))))), (1.0) / (2.0)) + ((-1.0)*pow((1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))) + ((((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))))), (1.0) / (2.0))))))) + ((2.0)*1.0 / (((L)))*((v0)+((-1.0)*(v2)))*(((u1)*(v0)) + ((-1.0)*(u2)*(v0)) + ((-1.0)*(u0)*(v1)) + ((u2)*(v1)) + ((u0)*(v2)) + ((-1.0)*(u1)*(v2)))*1.0 / (((y)))*1.0 / (((pow((1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))) + ((((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))))), (1.0) / (2.0)) + ((-1.0)*pow((1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))) + ((((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))))), (1.0) / (2.0))))*(pow((1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))) + ((((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))))), (1.0) / (2.0)) + ((-1.0)*pow((1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))) + ((((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))))), (1.0) / (2.0)))))))));
	newgradient[2 * ip1 + 1] += (pow((1.0 / (((L)))*1.0 / (((y)))*(((((u1)*(v0)) + ((-1.0)*(u2)*(v0)) + ((-1.0)*(u0)*(v1)) + ((u2)*(v1)) + ((u0)*(v2)) + ((-1.0)*(u1)*(v2)))*(((u1)*(v0)) + ((-1.0)*(u2)*(v0)) + ((-1.0)*(u0)*(v1)) + ((u2)*(v1)) + ((u0)*(v2)) + ((-1.0)*(u1)*(v2)))) + (((L)*(L))*((y)*(y))))*1.0 / (((pow((1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))) + ((((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))))), (1.0) / (2.0)) + ((-1.0)*pow((1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))) + ((((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))))), (1.0) / (2.0))))*(pow((1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))) + ((((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))))), (1.0) / (2.0)) + ((-1.0)*pow((1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))) + ((((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))))), (1.0) / (2.0))))))), (-1.0) / (2.0))*(((-2.0)*1.0 / (((L)))*1.0 / (((y)))*(((((u1)*(v0)) + ((-1.0)*(u2)*(v0)) + ((-1.0)*(u0)*(v1)) + ((u2)*(v1)) + ((u0)*(v2)) + ((-1.0)*(u1)*(v2)))*(((u1)*(v0)) + ((-1.0)*(u2)*(v0)) + ((-1.0)*(u0)*(v1)) + ((u2)*(v1)) + ((u0)*(v2)) + ((-1.0)*(u1)*(v2)))) + (((L)*(L))*((y)*(y))))*(((1.0) / (2.0)*1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((2.0)*(x)*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))) + ((-2.0)*(y)*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))))*pow((1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))) + ((((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))))), (-1.0) / (2.0))) + ((-1.0) / (2.0)*1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((2.0)*(x)*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))) + ((2.0)*(y)*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))))*pow((1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))) + ((((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))))), (-1.0) / (2.0))))*1.0 / (((pow((1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))) + ((((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))))), (1.0) / (2.0)) + ((-1.0)*pow((1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))) + ((((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))))), (1.0) / (2.0))))*(pow((1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))) + ((((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))))), (1.0) / (2.0)) + ((-1.0)*pow((1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))) + ((((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))))), (1.0) / (2.0))))*(pow((1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))) + ((((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))))), (1.0) / (2.0)) + ((-1.0)*pow((1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))) + ((((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))))), (1.0) / (2.0))))))) + ((2.0)*1.0 / (((L)))*(((-1.0)*(u0)) + (u2))*(((u1)*(v0)) + ((-1.0)*(u2)*(v0)) + ((-1.0)*(u0)*(v1)) + ((u2)*(v1)) + ((u0)*(v2)) + ((-1.0)*(u1)*(v2)))*1.0 / (((y)))*1.0 / (((pow((1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))) + ((((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))))), (1.0) / (2.0)) + ((-1.0)*pow((1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))) + ((((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))))), (1.0) / (2.0))))*(pow((1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))) + ((((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))))), (1.0) / (2.0)) + ((-1.0)*pow((1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))) + ((((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))))), (1.0) / (2.0)))))))));

	newgradient[2 * j] += (pow((1.0 / (((L)))*1.0 / (((y)))*(((((u1)*(v0)) + ((-1.0)*(u2)*(v0)) + ((-1.0)*(u0)*(v1)) + ((u2)*(v1)) + ((u0)*(v2)) + ((-1.0)*(u1)*(v2)))*(((u1)*(v0)) + ((-1.0)*(u2)*(v0)) + ((-1.0)*(u0)*(v1)) + ((u2)*(v1)) + ((u0)*(v2)) + ((-1.0)*(u1)*(v2)))) + (((L)*(L))*((y)*(y))))*1.0 / (((pow((1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))) + ((((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))))), (1.0) / (2.0)) + ((-1.0)*pow((1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))) + ((((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))))), (1.0) / (2.0))))*(pow((1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))) + ((((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))))), (1.0) / (2.0)) + ((-1.0)*pow((1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))) + ((((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))))), (1.0) / (2.0))))))), (-1.0) / (2.0))*(((-2.0)*1.0 / (((L)))*1.0 / (((y)))*(((((u1)*(v0)) + ((-1.0)*(u2)*(v0)) + ((-1.0)*(u0)*(v1)) + ((u2)*(v1)) + ((u0)*(v2)) + ((-1.0)*(u1)*(v2)))*(((u1)*(v0)) + ((-1.0)*(u2)*(v0)) + ((-1.0)*(u0)*(v1)) + ((u2)*(v1)) + ((u0)*(v2)) + ((-1.0)*(u1)*(v2)))) + (((L)*(L))*((y)*(y))))*(((-1.0)*1.0 / (((L)))*1.0 / (((y)*(y)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))*pow((1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))) + ((((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))))), (-1.0) / (2.0))) + (1.0 / (((L)))*1.0 / (((y)*(y)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))*pow((1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))) + ((((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))))), (-1.0) / (2.0))))*1.0 / (((pow((1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))) + ((((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))))), (1.0) / (2.0)) + ((-1.0)*pow((1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))) + ((((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))))), (1.0) / (2.0))))*(pow((1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))) + ((((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))))), (1.0) / (2.0)) + ((-1.0)*pow((1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))) + ((((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))))), (1.0) / (2.0))))*(pow((1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))) + ((((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))))), (1.0) / (2.0)) + ((-1.0)*pow((1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))) + ((((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))))), (1.0) / (2.0))))))) + ((2.0)*1.0 / (((L)))*(((-1.0)*(v0)) + (v1))*(((u1)*(v0)) + ((-1.0)*(u2)*(v0)) + ((-1.0)*(u0)*(v1)) + ((u2)*(v1)) + ((u0)*(v2)) + ((-1.0)*(u1)*(v2)))*1.0 / (((y)))*1.0 / (((pow((1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))) + ((((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))))), (1.0) / (2.0)) + ((-1.0)*pow((1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))) + ((((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))))), (1.0) / (2.0))))*(pow((1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))) + ((((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))))), (1.0) / (2.0)) + ((-1.0)*pow((1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))) + ((((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))))), (1.0) / (2.0)))))))));
	newgradient[2 * j + 1] += (pow((1.0 / (((L)))*1.0 / (((y)))*(((((u1)*(v0)) + ((-1.0)*(u2)*(v0)) + ((-1.0)*(u0)*(v1)) + ((u2)*(v1)) + ((u0)*(v2)) + ((-1.0)*(u1)*(v2)))*(((u1)*(v0)) + ((-1.0)*(u2)*(v0)) + ((-1.0)*(u0)*(v1)) + ((u2)*(v1)) + ((u0)*(v2)) + ((-1.0)*(u1)*(v2)))) + (((L)*(L))*((y)*(y))))*1.0 / (((pow((1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))) + ((((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))))), (1.0) / (2.0)) + ((-1.0)*pow((1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))) + ((((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))))), (1.0) / (2.0))))*(pow((1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))) + ((((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))))), (1.0) / (2.0)) + ((-1.0)*pow((1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))) + ((((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))))), (1.0) / (2.0))))))), (-1.0) / (2.0))*(((-2.0)*1.0 / (((L)))*1.0 / (((y)))*(((((u1)*(v0)) + ((-1.0)*(u2)*(v0)) + ((-1.0)*(u0)*(v1)) + ((u2)*(v1)) + ((u0)*(v2)) + ((-1.0)*(u1)*(v2)))*(((u1)*(v0)) + ((-1.0)*(u2)*(v0)) + ((-1.0)*(u0)*(v1)) + ((u2)*(v1)) + ((u0)*(v2)) + ((-1.0)*(u1)*(v2)))) + (((L)*(L))*((y)*(y))))*(((-1.0)*1.0 / (((L)))*1.0 / (((y)*(y)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))*pow((1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))) + ((((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))))), (-1.0) / (2.0))) + (1.0 / (((L)))*1.0 / (((y)*(y)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))*pow((1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))) + ((((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))))), (-1.0) / (2.0))))*1.0 / (((pow((1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))) + ((((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))))), (1.0) / (2.0)) + ((-1.0)*pow((1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))) + ((((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))))), (1.0) / (2.0))))*(pow((1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))) + ((((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))))), (1.0) / (2.0)) + ((-1.0)*pow((1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))) + ((((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))))), (1.0) / (2.0))))*(pow((1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))) + ((((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))))), (1.0) / (2.0)) + ((-1.0)*pow((1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))) + ((((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))))), (1.0) / (2.0))))))) + ((2.0)*1.0 / (((L)))*((u0)+((-1.0)*(u1)))*(((u1)*(v0)) + ((-1.0)*(u2)*(v0)) + ((-1.0)*(u0)*(v1)) + ((u2)*(v1)) + ((u0)*(v2)) + ((-1.0)*(u1)*(v2)))*1.0 / (((y)))*1.0 / (((pow((1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))) + ((((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))))), (1.0) / (2.0)) + ((-1.0)*pow((1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))) + ((((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))))), (1.0) / (2.0))))*(pow((1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((-1.0)*(u0)*(y)) + ((u1)*(y)))) + ((((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((v0)*(y)) + ((-1.0)*(v1)*(y)))))), (1.0) / (2.0)) + ((-1.0)*pow((1.0 / (((L)*(L)))*1.0 / (((y)*(y)))*(((((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))*(((L)*(v0)) + ((-1.0)*(L)*(v2)) + ((-1.0)*(v0)*(x)) + ((v1)*(x)) + ((u0)*(y)) + ((-1.0)*(u1)*(y)))) + ((((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))*(((L)*(u0)) + ((-1.0)*(L)*(u2)) + ((-1.0)*(u0)*(x)) + ((u1)*(x)) + ((-1.0)*(v0)*(y)) + ((v1)*(y)))))), (1.0) / (2.0)))))))));
}

double yaron_function_tri2(double L, double x, double y, double u0, double v0, double u1, double v1, double u2, double v2)
{
	return ((4.0)*1.0/(((L)))*1.0/(((y)))*(((((-1.0)*(u2)*(v0))+((-1.0)*(u0)*(v1))+((u2)*(v1))+((u1)*((v0)+((-1.0)*(v2))))+((u0)*(v2)))*(((-1.0)*(u2)*(v0))+((-1.0)*(u0)*(v1))+((u2)*(v1))+((u1)*((v0)+((-1.0)*(v2))))+((u0)*(v2))))+(((L)*(L))*((y)*(y))))*1.0/(((((-1.0)*pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((-1.0)*(L)*(v0))+((L)*(v2))+((v0)*(x))+((-1.0)*(v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y)))*(((-1.0)*(L)*(v0))+((L)*(v2))+((v0)*(x))+((-1.0)*(v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))))),(1.0)/(2.0)))+pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))))),(1.0)/(2.0)))*(((-1.0)*pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((-1.0)*(L)*(v0))+((L)*(v2))+((v0)*(x))+((-1.0)*(v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y)))*(((-1.0)*(L)*(v0))+((L)*(v2))+((v0)*(x))+((-1.0)*(v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))))),(1.0)/(2.0)))+pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))))),(1.0)/(2.0))))));
}
void yaron_function_grad2(double *newgradient, double L, double x, double y, double u0, double v0, double u1, double v1, double u2, double v2, int i, int ip1, int j)
{
	if(i != -1)
	{
	newgradient[i*2] += ((8.0)*1.0/(((L)))*1.0/(((y)))*1.0/(((((-1.0)*pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))))),(1.0)/(2.0)))+pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))))),(1.0)/(2.0)))*(((-1.0)*pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))))),(1.0)/(2.0)))+pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))))),(1.0)/(2.0)))*(((-1.0)*pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))))),(1.0)/(2.0)))+pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))))),(1.0)/(2.0)))))*(((((-1.0)*(v1))+(v2))*(((u2)*(((-1.0)*(v0))+(v1)))+((u1)*((v0)+((-1.0)*(v2))))+((u0)*(((-1.0)*(v1))+(v2))))*(((-1.0)*pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))))),(1.0)/(2.0)))+pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))))),(1.0)/(2.0))))+((-1.0)/(2.0)*1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((u2)*(((-1.0)*(v0))+(v1)))+((u1)*((v0)+((-1.0)*(v2))))+((u0)*(((-1.0)*(v1))+(v2))))*(((u2)*(((-1.0)*(v0))+(v1)))+((u1)*((v0)+((-1.0)*(v2))))+((u0)*(((-1.0)*(v1))+(v2)))))+(((L)*(L))*((y)*(y))))*(((2.0)*pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))))),(-1.0)/(2.0))*((((L)*(L))*((u0)+((-1.0)*(u2))))+((L)*(((-2.0)*(u0)*(x))+((u1)*(x))+((u2)*(x))+((v1)*(y))+((-1.0)*(v2)*(y))))+(((u0)+((-1.0)*(u1)))*(((x)*(x))+((y)*(y))))))+((-2.0)*pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))))),(-1.0)/(2.0))*((((L)*(L))*((u0)+((-1.0)*(u2))))+((L)*(((-2.0)*(u0)*(x))+((u1)*(x))+((u2)*(x))+((-1.0)*(v1)*(y))+((v2)*(y))))+(((u0)+((-1.0)*(u1)))*(((x)*(x))+((y)*(y))))))))));
	newgradient[i*2+1] += ((8.0)*1.0/(((L)))*1.0/(((y)))*1.0/(((((-1.0)*pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))))),(1.0)/(2.0)))+pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))))),(1.0)/(2.0)))*(((-1.0)*pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))))),(1.0)/(2.0)))+pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))))),(1.0)/(2.0)))*(((-1.0)*pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))))),(1.0)/(2.0)))+pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))))),(1.0)/(2.0)))))*((((u1)+((-1.0)*(u2)))*(((u2)*(((-1.0)*(v0))+(v1)))+((u1)*((v0)+((-1.0)*(v2))))+((u0)*(((-1.0)*(v1))+(v2))))*(((-1.0)*pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))))),(1.0)/(2.0)))+pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))))),(1.0)/(2.0))))+((-1.0)/(2.0)*1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((u2)*(((-1.0)*(v0))+(v1)))+((u1)*((v0)+((-1.0)*(v2))))+((u0)*(((-1.0)*(v1))+(v2))))*(((u2)*(((-1.0)*(v0))+(v1)))+((u1)*((v0)+((-1.0)*(v2))))+((u0)*(((-1.0)*(v1))+(v2)))))+(((L)*(L))*((y)*(y))))*(((-2.0)*pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))))),(-1.0)/(2.0))*((((L)*(L))*((v0)+((-1.0)*(v2))))+((L)*(((-2.0)*(v0)*(x))+((v1)*(x))+((v2)*(x))+((u1)*(y))+((-1.0)*(u2)*(y))))+(((v0)+((-1.0)*(v1)))*(((x)*(x))+((y)*(y))))))+((2.0)*pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))))),(-1.0)/(2.0))*((((L)*(L))*((v0)+((-1.0)*(v2))))+((L)*(((-2.0)*(v0)*(x))+((v1)*(x))+((v2)*(x))+((-1.0)*(u1)*(y))+((u2)*(y))))+(((v0)+((-1.0)*(v1)))*(((x)*(x))+((y)*(y))))))))));
	}

	if(ip1 != -1)
	{
	newgradient[ip1*2] += ((8.0)*1.0/(((L)))*1.0/(((y)))*1.0/(((((-1.0)*pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))))),(1.0)/(2.0)))+pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))))),(1.0)/(2.0)))*(((-1.0)*pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))))),(1.0)/(2.0)))+pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))))),(1.0)/(2.0)))*(((-1.0)*pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))))),(1.0)/(2.0)))+pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))))),(1.0)/(2.0)))))*((((v0)+((-1.0)*(v2)))*(((u2)*((v0)+((-1.0)*(v1))))+((u0)*((v1)+((-1.0)*(v2))))+((u1)*(((-1.0)*(v0))+(v2))))*(pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))))),(1.0)/(2.0))+((-1.0)*pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))))),(1.0)/(2.0)))))+((-1.0)/(2.0)*1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((u2)*(((-1.0)*(v0))+(v1)))+((u1)*((v0)+((-1.0)*(v2))))+((u0)*(((-1.0)*(v1))+(v2))))*(((u2)*(((-1.0)*(v0))+(v1)))+((u1)*((v0)+((-1.0)*(v2))))+((u0)*(((-1.0)*(v1))+(v2)))))+(((L)*(L))*((y)*(y))))*(((-2.0)*pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))))),(-1.0)/(2.0))*(((L)*(((u0)*(x))+((-1.0)*(u2)*(x))+((v0)*(y))+((-1.0)*(v2)*(y))))+((-1.0)*((u0)+((-1.0)*(u1)))*(((x)*(x))+((y)*(y))))))+((2.0)*pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))))),(-1.0)/(2.0))*(((L)*(((u0)*(x))+((-1.0)*(u2)*(x))+((-1.0)*(v0)*(y))+((v2)*(y))))+((-1.0)*((u0)+((-1.0)*(u1)))*(((x)*(x))+((y)*(y))))))))));
	newgradient[ip1*2+1] += ((8.0)*1.0/(((L)))*1.0/(((y)))*1.0/(((((-1.0)*pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))))),(1.0)/(2.0)))+pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))))),(1.0)/(2.0)))*(((-1.0)*pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))))),(1.0)/(2.0)))+pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))))),(1.0)/(2.0)))*(((-1.0)*pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))))),(1.0)/(2.0)))+pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))))),(1.0)/(2.0)))))*((((u0)+((-1.0)*(u2)))*(((u2)*(((-1.0)*(v0))+(v1)))+((u1)*((v0)+((-1.0)*(v2))))+((u0)*(((-1.0)*(v1))+(v2))))*(pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))))),(1.0)/(2.0))+((-1.0)*pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))))),(1.0)/(2.0)))))+((-1.0)/(2.0)*1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((u2)*(((-1.0)*(v0))+(v1)))+((u1)*((v0)+((-1.0)*(v2))))+((u0)*(((-1.0)*(v1))+(v2))))*(((u2)*(((-1.0)*(v0))+(v1)))+((u1)*((v0)+((-1.0)*(v2))))+((u0)*(((-1.0)*(v1))+(v2)))))+(((L)*(L))*((y)*(y))))*(((2.0)*pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))))),(-1.0)/(2.0))*(((L)*(((v0)*(x))+((-1.0)*(v2)*(x))+((u0)*(y))+((-1.0)*(u2)*(y))))+((-1.0)*((v0)+((-1.0)*(v1)))*(((x)*(x))+((y)*(y))))))+((2.0)*pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))))),(-1.0)/(2.0))*(((L)*(((-1.0)*(v0)*(x))+((v2)*(x))+((u0)*(y))+((-1.0)*(u2)*(y))))+(((v0)+((-1.0)*(v1)))*(((x)*(x))+((y)*(y))))))))));
	}

	if(j!= -1)
	{
	newgradient[j*2] += ((8.0)*1.0/(((L)))*1.0/(((y)))*1.0/(((((-1.0)*pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))))),(1.0)/(2.0)))+pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))))),(1.0)/(2.0)))*(((-1.0)*pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))))),(1.0)/(2.0)))+pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))))),(1.0)/(2.0)))*(((-1.0)*pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))))),(1.0)/(2.0)))+pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))))),(1.0)/(2.0)))))*(((-1.0)*1.0/(((L)))*1.0/(((y)*(y)))*(((((u2)*(((-1.0)*(v0))+(v1)))+((u1)*((v0)+((-1.0)*(v2))))+((u0)*(((-1.0)*(v1))+(v2))))*(((u2)*(((-1.0)*(v0))+(v1)))+((u1)*((v0)+((-1.0)*(v2))))+((u0)*(((-1.0)*(v1))+(v2)))))+(((L)*(L))*((y)*(y))))*(((((L)*((u0)+((-1.0)*(u2))))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))*pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))))),(-1.0)/(2.0)))+((((L)*(((-1.0)*(u0))+(u2)))+((u0)*(x))+((-1.0)*(u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))*pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))))),(-1.0)/(2.0)))))+((((-1.0)*(v0))+(v1))*(((u2)*(((-1.0)*(v0))+(v1)))+((u1)*((v0)+((-1.0)*(v2))))+((u0)*(((-1.0)*(v1))+(v2))))*(((-1.0)*pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))))),(1.0)/(2.0)))+pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))))),(1.0)/(2.0))))));
	newgradient[j*2+1] += ((8.0)*1.0/(((L)))*1.0/(((y)))*1.0/(((((-1.0)*pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))))),(1.0)/(2.0)))+pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))))),(1.0)/(2.0)))*(((-1.0)*pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))))),(1.0)/(2.0)))+pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))))),(1.0)/(2.0)))*(((-1.0)*pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))))),(1.0)/(2.0)))+pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))))),(1.0)/(2.0)))))*(((-1.0)*1.0/(((L)))*1.0/(((y)*(y)))*(((((u2)*(((-1.0)*(v0))+(v1)))+((u1)*((v0)+((-1.0)*(v2))))+((u0)*(((-1.0)*(v1))+(v2))))*(((u2)*(((-1.0)*(v0))+(v1)))+((u1)*((v0)+((-1.0)*(v2))))+((u0)*(((-1.0)*(v1))+(v2)))))+(((L)*(L))*((y)*(y))))*(((((L)*((v0)+((-1.0)*(v2))))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y)))*pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))))),(-1.0)/(2.0)))+((((L)*(((-1.0)*(v0))+(v2)))+((v0)*(x))+((-1.0)*(v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y)))*pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))))),(-1.0)/(2.0)))))+(((u0)+((-1.0)*(u1)))*(((u2)*(((-1.0)*(v0))+(v1)))+((u1)*((v0)+((-1.0)*(v2))))+((u0)*(((-1.0)*(v1))+(v2))))*(((-1.0)*pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))))),(1.0)/(2.0)))+pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))))),(1.0)/(2.0))))));
	}
}


double syaron_function_tri(double L, double x, double y, double u0, double v0, double u1, double v1, double u2, double v2)
{
	return ((2.0)*(((u2)*(v0))+((u0)*(v1))+((-1.0)*(u2)*(v1))+((-1.0)*(u0)*(v2))+((u1)*(((-1.0)*(v0))+(v2)))+((L)*(y)))*1.0/(((((-1.0)*pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((-1.0)*(L)*(v0))+((L)*(v2))+((v0)*(x))+((-1.0)*(v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y)))*(((-1.0)*(L)*(v0))+((L)*(v2))+((v0)*(x))+((-1.0)*(v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))))),(1.0)/(2.0)))+pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))))),(1.0)/(2.0))))));
}
void syaron_function_grad(double *newgradient, double L, double x, double y, double u0, double v0, double u1, double v1, double u2, double v2, int i, int ip1, int j)
{

	if(i != -1){
	newgradient[i*2] += ((2.0)*1.0/(((pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))))),(1.0)/(2.0))+((-1.0)*pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))))),(1.0)/(2.0))))*(pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))))),(1.0)/(2.0))+((-1.0)*pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))))),(1.0)/(2.0))))))*(((((-1.0)*(v1))+(v2))*(pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))))),(1.0)/(2.0))+((-1.0)*pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))))),(1.0)/(2.0)))))+((-1.0)/(2.0)*1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((u2)*((v0)+((-1.0)*(v1))))+((u0)*(v1))+((-1.0)*(u0)*(v2))+((u1)*(((-1.0)*(v0))+(v2)))+((L)*(y)))*(((2.0)*pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))))),(-1.0)/(2.0))*((((L)*(L))*((u0)+((-1.0)*(u2))))+((L)*(((-2.0)*(u0)*(x))+((u1)*(x))+((u2)*(x))+((v1)*(y))+((-1.0)*(v2)*(y))))+(((u0)+((-1.0)*(u1)))*(((x)*(x))+((y)*(y))))))+((-2.0)*pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))))),(-1.0)/(2.0))*((((L)*(L))*((u0)+((-1.0)*(u2))))+((L)*(((-2.0)*(u0)*(x))+((u1)*(x))+((u2)*(x))+((-1.0)*(v1)*(y))+((v2)*(y))))+(((u0)+((-1.0)*(u1)))*(((x)*(x))+((y)*(y))))))))));
	newgradient[i*2+1] += ((2.0)*1.0/(((pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))))),(1.0)/(2.0))+((-1.0)*pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))))),(1.0)/(2.0))))*(pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))))),(1.0)/(2.0))+((-1.0)*pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))))),(1.0)/(2.0))))))*(((((-1.0)*(u1))+(u2))*(((-1.0)*pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))))),(1.0)/(2.0)))+pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))))),(1.0)/(2.0))))+((-1.0)/(2.0)*1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((u2)*((v0)+((-1.0)*(v1))))+((u0)*(v1))+((-1.0)*(u0)*(v2))+((u1)*(((-1.0)*(v0))+(v2)))+((L)*(y)))*(((-2.0)*pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))))),(-1.0)/(2.0))*((((L)*(L))*((v0)+((-1.0)*(v2))))+((L)*(((-2.0)*(v0)*(x))+((v1)*(x))+((v2)*(x))+((u1)*(y))+((-1.0)*(u2)*(y))))+(((v0)+((-1.0)*(v1)))*(((x)*(x))+((y)*(y))))))+((2.0)*pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))))),(-1.0)/(2.0))*((((L)*(L))*((v0)+((-1.0)*(v2))))+((L)*(((-2.0)*(v0)*(x))+((v1)*(x))+((v2)*(x))+((-1.0)*(u1)*(y))+((u2)*(y))))+(((v0)+((-1.0)*(v1)))*(((x)*(x))+((y)*(y))))))))));
	}

	if(ip1 != -1)
	{
	newgradient[ip1*2] += ((2.0)*1.0/(((pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))))),(1.0)/(2.0))+((-1.0)*pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))))),(1.0)/(2.0))))*(pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))))),(1.0)/(2.0))+((-1.0)*pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))))),(1.0)/(2.0))))))*((((v0)+((-1.0)*(v2)))*(pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))))),(1.0)/(2.0))+((-1.0)*pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))))),(1.0)/(2.0)))))+((-1.0)/(2.0)*1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((u2)*((v0)+((-1.0)*(v1))))+((u0)*(v1))+((-1.0)*(u0)*(v2))+((u1)*(((-1.0)*(v0))+(v2)))+((L)*(y)))*(((-2.0)*pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))))),(-1.0)/(2.0))*(((L)*(((u0)*(x))+((-1.0)*(u2)*(x))+((v0)*(y))+((-1.0)*(v2)*(y))))+((-1.0)*((u0)+((-1.0)*(u1)))*(((x)*(x))+((y)*(y))))))+((2.0)*pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))))),(-1.0)/(2.0))*(((L)*(((u0)*(x))+((-1.0)*(u2)*(x))+((-1.0)*(v0)*(y))+((v2)*(y))))+((-1.0)*((u0)+((-1.0)*(u1)))*(((x)*(x))+((y)*(y))))))))));
	newgradient[ip1*2+1] += ((2.0)*1.0/(((pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))))),(1.0)/(2.0))+((-1.0)*pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))))),(1.0)/(2.0))))*(pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))))),(1.0)/(2.0))+((-1.0)*pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))))),(1.0)/(2.0))))))*((((u0)+((-1.0)*(u2)))*(((-1.0)*pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))))),(1.0)/(2.0)))+pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))))),(1.0)/(2.0))))+((-1.0)/(2.0)*1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((u2)*((v0)+((-1.0)*(v1))))+((u0)*(v1))+((-1.0)*(u0)*(v2))+((u1)*(((-1.0)*(v0))+(v2)))+((L)*(y)))*(((2.0)*pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))))),(-1.0)/(2.0))*(((L)*(((v0)*(x))+((-1.0)*(v2)*(x))+((u0)*(y))+((-1.0)*(u2)*(y))))+((-1.0)*((v0)+((-1.0)*(v1)))*(((x)*(x))+((y)*(y))))))+((2.0)*pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))))),(-1.0)/(2.0))*(((L)*(((-1.0)*(v0)*(x))+((v2)*(x))+((u0)*(y))+((-1.0)*(u2)*(y))))+(((v0)+((-1.0)*(v1)))*(((x)*(x))+((y)*(y))))))))));
	}

	if(j != -1){

	newgradient[j*2] += ((2.0)*1.0/(((pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))))),(1.0)/(2.0))+((-1.0)*pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))))),(1.0)/(2.0))))*(pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))))),(1.0)/(2.0))+((-1.0)*pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))))),(1.0)/(2.0))))))*(((-1.0)*1.0/(((L)))*1.0/(((y)*(y)))*(((u2)*((v0)+((-1.0)*(v1))))+((u0)*(v1))+((-1.0)*(u0)*(v2))+((u1)*(((-1.0)*(v0))+(v2)))+((L)*(y)))*(((((L)*((u0)+((-1.0)*(u2))))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))*pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))))),(-1.0)/(2.0)))+((((L)*(((-1.0)*(u0))+(u2)))+((u0)*(x))+((-1.0)*(u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))*pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))))),(-1.0)/(2.0)))))+(((v0)+((-1.0)*(v1)))*(((-1.0)*pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))))),(1.0)/(2.0)))+pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))))),(1.0)/(2.0))))));
	newgradient[j*2+1] += ((2.0)*1.0/(((pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))))),(1.0)/(2.0))+((-1.0)*pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))))),(1.0)/(2.0))))*(pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))))),(1.0)/(2.0))+((-1.0)*pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))))),(1.0)/(2.0))))))*(((-1.0)*1.0/(((L)))*1.0/(((y)*(y)))*(((u2)*((v0)+((-1.0)*(v1))))+((u0)*(v1))+((-1.0)*(u0)*(v2))+((u1)*(((-1.0)*(v0))+(v2)))+((L)*(y)))*(((((L)*((v0)+((-1.0)*(v2))))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y)))*pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))))),(-1.0)/(2.0)))+((((L)*(((-1.0)*(v0))+(v2)))+((v0)*(x))+((-1.0)*(v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y)))*pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))))),(-1.0)/(2.0)))))+(((u0)+((-1.0)*(u1)))*(pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))))),(1.0)/(2.0))+((-1.0)*pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))))),(1.0)/(2.0)))))));
	}
}



double confromal_function_tri(double L, double x, double y, double u0, double v0, double u1, double v1, double u2, double v2)
{
	return ((L)*(y)*1.0/(((((-1.0)*pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((-1.0)*(L)*(v0))+((L)*(v2))+((v0)*(x))+((-1.0)*(v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y)))*(((-1.0)*(L)*(v0))+((L)*(v2))+((v0)*(x))+((-1.0)*(v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))))),(1.0)/(2.0)))+pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))))),(1.0)/(2.0)))))*(pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((-1.0)*(L)*(v0))+((L)*(v2))+((v0)*(x))+((-1.0)*(v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y)))*(((-1.0)*(L)*(v0))+((L)*(v2))+((v0)*(x))+((-1.0)*(v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))))),(1.0)/(2.0))+pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))))),(1.0)/(2.0))));
}
void conformal_function_grad(double *newgradient, double L, double x, double y, double u0, double v0, double u1, double v1, double u2, double v2, int i, int ip1, int j)
{
	if(i != -1)
	{
	newgradient[i*2] += ((4.0)*1.0/(((L)*(L)))*1.0/(((y)*(y)))*pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))))),(-1.0)/(2.0))*pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))))),(-1.0)/(2.0))*((((L)*(L))*(((-2.0)*((u2)*(u2))*(v0))+(((u2)*(u2))*(v1))+((-1.0)*((v0)*(v0))*(v1))+((2.0)*(u1)*(u2)*((v0)+((-1.0)*(v2))))+(((u0)*(u0))*((v1)+((-1.0)*(v2))))+(((u2)*(u2))*(v2))+(((v0)*(v0))*(v2))+((2.0)*(v0)*(v1)*(v2))+((-2.0)*(v0)*((v2)*(v2)))+((-1.0)*(v1)*((v2)*(v2)))+((v2)*(v2)*(v2))+((2.0)*(u0)*(((u2)*((v0)+((-1.0)*(v1))))+((u1)*(((-1.0)*(v0))+(v2)))))))+((-2.0)*(L)*(((-1.0)*((v0)+((-1.0)*(v1)))*(((u2)*(u2))+(((v0)+((-1.0)*(v2)))*((v1)+((-1.0)*(v2))))))+(((u1)*(u1))*((v0)+((-1.0)*(v2))))+(((u0)*(u0))*((v1)+((-1.0)*(v2))))+((2.0)*(u0)*(((u2)*((v0)+((-1.0)*(v1))))+((u1)*(((-1.0)*(v0))+(v2))))))*(x))+((((2.0)*(u1)*(u2)*(((-1.0)*(v0))+(v1)))+(((u1)*(u1))*(((2.0)*(v0))+((-1.0)*(v1))+((-1.0)*(v2))))+(((u0)*(u0))*((v1)+((-1.0)*(v2))))+((-1.0)*(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v1))))*((v1)+((-1.0)*(v2))))+((2.0)*(u0)*(((u2)*((v0)+((-1.0)*(v1))))+((u1)*(((-1.0)*(v0))+(v2))))))*(((x)*(x))+((y)*(y)))))*1.0/(((pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))))),(1.0)/(2.0))+((-1.0)*pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))))),(1.0)/(2.0))))*(pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))))),(1.0)/(2.0))+((-1.0)*pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))))),(1.0)/(2.0)))))));
	newgradient[i*2+1] += ((4.0)*1.0/(((L)*(L)))*1.0/(((y)*(y)))*pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))))),(-1.0)/(2.0))*pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))))),(-1.0)/(2.0))*((((L)*(L))*((((u0)*(u0))*((u1)+((-1.0)*(u2))))+((u1)*(((u2)*(u2))+((-1.0)*(((v0)+((-1.0)*(v2)))*((v0)+((-1.0)*(v2)))))))+((-1.0)*(u2)*(((u2)*(u2))+((-1.0)*((v0)+((-1.0)*(v2)))*((v0)+((-2.0)*(v1))+(v2)))))+((-2.0)*(u0)*(((u1)*(u2))+((-1.0)*((u2)*(u2)))+(((v0)+((-1.0)*(v2)))*(((-1.0)*(v1))+(v2)))))))+((-2.0)*(L)*((((u0)*(u0))*((u1)+((-1.0)*(u2))))+(((u1)*(u1))*(u2))+((u2)*(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v1)))))+((-1.0)*(u1)*(((u2)*(u2))+(((v0)+((-1.0)*(v2)))*((v0)+((-1.0)*(v2))))))+((u0)*(((-1.0)*((u1)*(u1)))+((u2)*(u2))+((2.0)*(v0)*(v1))+((-1.0)*((v1)*(v1)))+((-2.0)*(v0)*(v2))+((v2)*(v2)))))*(x))+((((u1)*(u1)*(u1))+(((u0)*(u0))*((u1)+((-1.0)*(u2))))+((-1.0)*((u1)*(u1))*(u2))+((u2)*(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v1)))))+((-2.0)*(u0)*(((u1)*(u1))+((-1.0)*(u1)*(u2))+((-1.0)*((v0)+((-1.0)*(v1)))*((v1)+((-1.0)*(v2))))))+((-1.0)*(u1)*((v0)+((-1.0)*(v1)))*((v0)+(v1)+((-2.0)*(v2)))))*(((x)*(x))+((y)*(y)))))*1.0/(((pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))))),(1.0)/(2.0))+((-1.0)*pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))))),(1.0)/(2.0))))*(pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))))),(1.0)/(2.0))+((-1.0)*pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))))),(1.0)/(2.0)))))));
	}

	if(ip1 != -1){
	newgradient[ip1*2] += ((4.0)*1.0/(((L)*(L)))*1.0/(((y)*(y)))*pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))))),(-1.0)/(2.0))*pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))))),(-1.0)/(2.0))*((((L)*(L))*(((u0)*(u0))+((-2.0)*(u0)*(u2))+((u2)*(u2))+(((v0)+((-1.0)*(v2)))*((v0)+((-1.0)*(v2)))))*((v0)+((-1.0)*(v2))))+((-2.0)*(L)*((v0)+((-1.0)*(v1)))*(((u0)*(u0))+((-2.0)*(u0)*(u2))+((u2)*(u2))+(((v0)+((-1.0)*(v2)))*((v0)+((-1.0)*(v2)))))*(x))+((((2.0)*(u1)*(u2)*((v0)+((-1.0)*(v1))))+((((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v1))))*((v0)+((-1.0)*(v2))))+(((u1)*(u1))*(((-1.0)*(v0))+(v2)))+(((u0)*(u0))*((v0)+((-2.0)*(v1))+(v2)))+((-2.0)*(u0)*(((u2)*((v0)+((-1.0)*(v1))))+((u1)*(((-1.0)*(v1))+(v2))))))*(((x)*(x))+((y)*(y)))))*1.0/(((pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))))),(1.0)/(2.0))+((-1.0)*pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))))),(1.0)/(2.0))))*(pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))))),(1.0)/(2.0))+((-1.0)*pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))))),(1.0)/(2.0)))))));
	newgradient[ip1*2+1] += ((-4.0)*1.0/(((L)*(L)))*1.0/(((y)*(y)))*pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))))),(-1.0)/(2.0))*pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))))),(-1.0)/(2.0))*((((L)*(L))*((u0)+((-1.0)*(u2)))*(((u0)*(u0))+((-2.0)*(u0)*(u2))+((u2)*(u2))+(((v0)+((-1.0)*(v2)))*((v0)+((-1.0)*(v2))))))+((-2.0)*(L)*((u0)+((-1.0)*(u1)))*(((u0)*(u0))+((-2.0)*(u0)*(u2))+((u2)*(u2))+(((v0)+((-1.0)*(v2)))*((v0)+((-1.0)*(v2)))))*(x))+((((u0)*(u0)*(u0))+((-1.0)*((u1)*(u1))*(u2))+((-1.0)*((u0)*(u0))*(((2.0)*(u1))+(u2)))+((u2)*(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v1)))))+((u0)*(((u1)*(u1))+((2.0)*(u1)*(u2))+(((v0)+((-1.0)*(v1)))*((v0)+(v1)+((-2.0)*(v2))))))+((-2.0)*(u1)*((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v2)))))*(((x)*(x))+((y)*(y)))))*1.0/(((pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))))),(1.0)/(2.0))+((-1.0)*pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))))),(1.0)/(2.0))))*(pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))))),(1.0)/(2.0))+((-1.0)*pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))))),(1.0)/(2.0)))))));
	}

	if(j != -1)
	{
	newgradient[j*2] += ((-4.0)*1.0/(((L)*(L)))*1.0/(((y)*(y)))*pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))))),(-1.0)/(2.0))*pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))))),(-1.0)/(2.0))*((((L)*(L))*((((v0)+((-1.0)*(v1)))*(((-1.0)*((u2)*(u2)))+(((v0)+((-1.0)*(v2)))*((v0)+((-1.0)*(v2))))))+((-2.0)*(u0)*(((u1)*((v0)+((-1.0)*(v2))))+((u2)*((v1)+((-1.0)*(v2))))))+(((u0)*(u0))*((v0)+(v1)+((-2.0)*(v2))))+((2.0)*(u1)*(u2)*((v0)+((-1.0)*(v2))))))+((-2.0)*(L)*(((u0)*(u0))+((-2.0)*(u0)*(u1))+((u1)*(u1))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v1)))))*((v0)+((-1.0)*(v2)))*(x))+((((u0)*(u0))+((-2.0)*(u0)*(u1))+((u1)*(u1))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v1)))))*((v0)+((-1.0)*(v1)))*(((x)*(x))+((y)*(y)))))*1.0/(((pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))))),(1.0)/(2.0))+((-1.0)*pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))))),(1.0)/(2.0))))*(pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))))),(1.0)/(2.0))+((-1.0)*pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))))),(1.0)/(2.0)))))));
	newgradient[j*2+1] += ((4.0)*1.0/(((L)*(L)))*1.0/(((y)*(y)))*pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))))),(-1.0)/(2.0))*pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))))),(-1.0)/(2.0))*((((L)*(L))*(((u0)*(u0)*(u0))+((-1.0)*((u0)*(u0))*((u1)+((2.0)*(u2))))+((u1)*(((-1.0)*((u2)*(u2)))+(((v0)+((-1.0)*(v2)))*((v0)+((-1.0)*(v2))))))+((-2.0)*(u2)*((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v2))))+((u0)*(((2.0)*(u1)*(u2))+((u2)*(u2))+(((v0)+((-1.0)*(v2)))*((v0)+((-2.0)*(v1))+(v2)))))))+((-2.0)*(L)*((u0)+((-1.0)*(u2)))*(((u0)*(u0))+((-2.0)*(u0)*(u1))+((u1)*(u1))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v1)))))*(x))+(((u0)+((-1.0)*(u1)))*(((u0)*(u0))+((-2.0)*(u0)*(u1))+((u1)*(u1))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v1)))))*(((x)*(x))+((y)*(y)))))*1.0/(((pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))))),(1.0)/(2.0))+((-1.0)*pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))))),(1.0)/(2.0))))*(pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((-1.0)*(u0)*(y))+((u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y)))))),(1.0)/(2.0))+((-1.0)*pow((1.0/(((L)*(L)))*1.0/(((y)*(y)))*(((((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y)))*(((L)*(v0))+((-1.0)*(L)*(v2))+((-1.0)*(v0)*(x))+((v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y))))+((((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))*(((L)*(u0))+((-1.0)*(L)*(u2))+((-1.0)*(u0)*(x))+((u1)*(x))+((-1.0)*(v0)*(y))+((v1)*(y)))))),(1.0)/(2.0)))))));
	}
}

double mips_function_tri(double L, double x, double y, double u0, double v0, double u1, double v1, double u2, double v2)
{
	double fx =  (1.0/(((((u2)*((v0)+((-1.0)*(v1))))+((u0)*((v1)+((-1.0)*(v2))))+((u1)*(((-1.0)*(v0))+(v2))))))*((((L)*(L))*((((u0)+((-1.0)*(u2)))*((u0)+((-1.0)*(u2))))+(((v0)+((-1.0)*(v2)))*((v0)+((-1.0)*(v2))))))+((-2.0)*(L)*(((u0)*(u0))+((u1)*(u2))+((-1.0)*(u0)*((u1)+(u2)))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v2)))))*(x))+(((((u0)+((-1.0)*(u1)))*((u0)+((-1.0)*(u1))))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v1)))))*(((x)*(x))+((y)*(y))))));
	
	if(fx < 0)
	{
		int i = 0;
	}

	return fx;
}
void mips_function_grad(double *newgradient, double L, double x, double y, double u0, double v0, double u1, double v1, double u2, double v2, int i, int ip1, int j)
{
	if(i != -1){
	newgradient[i*2] += (1.0/(((((u1)*(v0))+((-1.0)*(u2)*(v0))+((-1.0)*(u0)*(v1))+((u2)*(v1))+((u0)*(v2))+((-1.0)*(u1)*(v2)))*(((u1)*(v0))+((-1.0)*(u2)*(v0))+((-1.0)*(u0)*(v1))+((u2)*(v1))+((u0)*(v2))+((-1.0)*(u1)*(v2)))))*(((2.0)*(((u2)*((v0)+((-1.0)*(v1))))+((u0)*((v1)+((-1.0)*(v2))))+((u1)*(((-1.0)*(v0))+(v2))))*((((L)*(L))*((u0)+((-1.0)*(u2))))+((L)*(((-2.0)*(u0))+(u1)+(u2))*(x))+(((u0)+((-1.0)*(u1)))*(((x)*(x))+((y)*(y))))))+((-1.0)*((v1)+((-1.0)*(v2)))*((((L)*(L))*((((u0)+((-1.0)*(u2)))*((u0)+((-1.0)*(u2))))+(((v0)+((-1.0)*(v2)))*((v0)+((-1.0)*(v2))))))+((-2.0)*(L)*(((u0)*(u0))+((u1)*(u2))+((-1.0)*(u0)*((u1)+(u2)))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v2)))))*(x))+(((((u0)+((-1.0)*(u1)))*((u0)+((-1.0)*(u1))))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v1)))))*(((x)*(x))+((y)*(y))))))));
	newgradient[i*2+1] += (1.0/(((((u1)*(v0))+((-1.0)*(u2)*(v0))+((-1.0)*(u0)*(v1))+((u2)*(v1))+((u0)*(v2))+((-1.0)*(u1)*(v2)))*(((u1)*(v0))+((-1.0)*(u2)*(v0))+((-1.0)*(u0)*(v1))+((u2)*(v1))+((u0)*(v2))+((-1.0)*(u1)*(v2)))))*(((-1.0)*(((-1.0)*(u1))+(u2))*((((L)*(L))*((((u0)+((-1.0)*(u2)))*((u0)+((-1.0)*(u2))))+(((v0)+((-1.0)*(v2)))*((v0)+((-1.0)*(v2))))))+((-2.0)*(L)*(((u0)*(u0))+((u1)*(u2))+((-1.0)*(u0)*((u1)+(u2)))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v2)))))*(x))+(((((u0)+((-1.0)*(u1)))*((u0)+((-1.0)*(u1))))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v1)))))*(((x)*(x))+((y)*(y))))))+((2.0)*(((u2)*((v0)+((-1.0)*(v1))))+((u0)*((v1)+((-1.0)*(v2))))+((u1)*(((-1.0)*(v0))+(v2))))*((((L)*(L))*((v0)+((-1.0)*(v2))))+((L)*(((-2.0)*(v0))+(v1)+(v2))*(x))+(((v0)+((-1.0)*(v1)))*(((x)*(x))+((y)*(y))))))));
	}

	if(ip1 != -1)
	{
	newgradient[ip1*2] += (1.0/(((((u1)*(v0))+((-1.0)*(u2)*(v0))+((-1.0)*(u0)*(v1))+((u2)*(v1))+((u0)*(v2))+((-1.0)*(u1)*(v2)))*(((u1)*(v0))+((-1.0)*(u2)*(v0))+((-1.0)*(u0)*(v1))+((u2)*(v1))+((u0)*(v2))+((-1.0)*(u1)*(v2)))))*(((((u2)*((v0)+((-1.0)*(v1))))+((u0)*((v1)+((-1.0)*(v2))))+((u1)*(((-1.0)*(v0))+(v2))))*(((2.0)*(L)*((u0)+((-1.0)*(u2)))*(x))+((-2.0)*((u0)+((-1.0)*(u1)))*(((x)*(x))+((y)*(y))))))+((-1.0)*(((-1.0)*(v0))+(v2))*((((L)*(L))*((((u0)+((-1.0)*(u2)))*((u0)+((-1.0)*(u2))))+(((v0)+((-1.0)*(v2)))*((v0)+((-1.0)*(v2))))))+((-2.0)*(L)*(((u0)*(u0))+((u1)*(u2))+((-1.0)*(u0)*((u1)+(u2)))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v2)))))*(x))+(((((u0)+((-1.0)*(u1)))*((u0)+((-1.0)*(u1))))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v1)))))*(((x)*(x))+((y)*(y))))))));
	newgradient[ip1*2+1] += (1.0/(((((u1)*(v0))+((-1.0)*(u2)*(v0))+((-1.0)*(u0)*(v1))+((u2)*(v1))+((u0)*(v2))+((-1.0)*(u1)*(v2)))*(((u1)*(v0))+((-1.0)*(u2)*(v0))+((-1.0)*(u0)*(v1))+((u2)*(v1))+((u0)*(v2))+((-1.0)*(u1)*(v2)))))*(((-1.0)*((u0)+((-1.0)*(u2)))*((((L)*(L))*((((u0)+((-1.0)*(u2)))*((u0)+((-1.0)*(u2))))+(((v0)+((-1.0)*(v2)))*((v0)+((-1.0)*(v2))))))+((-2.0)*(L)*(((u0)*(u0))+((u1)*(u2))+((-1.0)*(u0)*((u1)+(u2)))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v2)))))*(x))+(((((u0)+((-1.0)*(u1)))*((u0)+((-1.0)*(u1))))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v1)))))*(((x)*(x))+((y)*(y))))))+((((u2)*((v0)+((-1.0)*(v1))))+((u0)*((v1)+((-1.0)*(v2))))+((u1)*(((-1.0)*(v0))+(v2))))*(((2.0)*(L)*((v0)+((-1.0)*(v2)))*(x))+((-2.0)*((v0)+((-1.0)*(v1)))*(((x)*(x))+((y)*(y))))))));
	}

	if(j != -1)
	{
	newgradient[j*2] += (1.0/(((((u1)*(v0))+((-1.0)*(u2)*(v0))+((-1.0)*(u0)*(v1))+((u2)*(v1))+((u0)*(v2))+((-1.0)*(u1)*(v2)))*(((u1)*(v0))+((-1.0)*(u2)*(v0))+((-1.0)*(u0)*(v1))+((u2)*(v1))+((u0)*(v2))+((-1.0)*(u1)*(v2)))))*(((2.0)*(L)*(((u2)*((v0)+((-1.0)*(v1))))+((u0)*((v1)+((-1.0)*(v2))))+((u1)*(((-1.0)*(v0))+(v2))))*(((L)*(((-1.0)*(u0))+(u2)))+(((u0)+((-1.0)*(u1)))*(x))))+((-1.0)*((v0)+((-1.0)*(v1)))*((((L)*(L))*((((u0)+((-1.0)*(u2)))*((u0)+((-1.0)*(u2))))+(((v0)+((-1.0)*(v2)))*((v0)+((-1.0)*(v2))))))+((-2.0)*(L)*(((u0)*(u0))+((u1)*(u2))+((-1.0)*(u0)*((u1)+(u2)))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v2)))))*(x))+(((((u0)+((-1.0)*(u1)))*((u0)+((-1.0)*(u1))))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v1)))))*(((x)*(x))+((y)*(y))))))));
	newgradient[j*2+1] += (1.0/(((((u1)*(v0))+((-1.0)*(u2)*(v0))+((-1.0)*(u0)*(v1))+((u2)*(v1))+((u0)*(v2))+((-1.0)*(u1)*(v2)))*(((u1)*(v0))+((-1.0)*(u2)*(v0))+((-1.0)*(u0)*(v1))+((u2)*(v1))+((u0)*(v2))+((-1.0)*(u1)*(v2)))))*(((2.0)*(L)*(((u2)*(((-1.0)*(v0))+(v1)))+((u1)*((v0)+((-1.0)*(v2))))+((u0)*(((-1.0)*(v1))+(v2))))*(((L)*((v0)+((-1.0)*(v2))))+((((-1.0)*(v0))+(v1))*(x))))+((-1.0)*(((-1.0)*(u0))+(u1))*((((L)*(L))*((((u0)+((-1.0)*(u2)))*((u0)+((-1.0)*(u2))))+(((v0)+((-1.0)*(v2)))*((v0)+((-1.0)*(v2))))))+((-2.0)*(L)*(((u0)*(u0))+((u1)*(u2))+((-1.0)*(u0)*((u1)+(u2)))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v2)))))*(x))+(((((u0)+((-1.0)*(u1)))*((u0)+((-1.0)*(u1))))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v1)))))*(((x)*(x))+((y)*(y))))))));
	}
}


double lscm_function_tri(double L, double x, double y, double u0, double v0, double u1, double v1, double u2, double v2)
{
	return (1.0/(((L)))*1.0/(((y)))*((((L)*(L))*((((u0)+((-1.0)*(u2)))*((u0)+((-1.0)*(u2))))+(((v0)+((-1.0)*(v2)))*((v0)+((-1.0)*(v2))))))+((-2.0)*(L)*(((u0)*(u0))+((u1)*(u2))+((-1.0)*(u0)*((u1)+(u2)))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v2)))))*(x))+((2.0)*(L)*(((-1.0)*(u2)*(v0))+((-1.0)*(u0)*(v1))+((u2)*(v1))+((u1)*((v0)+((-1.0)*(v2))))+((u0)*(v2)))*(y))+(((((u0)+((-1.0)*(u1)))*((u0)+((-1.0)*(u1))))+(((v0)+((-1.0)*(v1)))*((v0)+((-1.0)*(v1)))))*(((x)*(x))+((y)*(y))))));
}
void lscm_function_grad(double *newgradient, double L, double x, double y, double u0, double v0, double u1, double v1, double u2, double v2, int i, int ip1, int j)
{

	if(i != -1)
	{
	newgradient[i*2] += ((2.0)*1.0/(((L)))*1.0/(((y)))*((((L)*(L))*((u0)+((-1.0)*(u2))))+((L)*(((-2.0)*(u0)*(x))+((u1)*(x))+((u2)*(x))+((-1.0)*(v1)*(y))+((v2)*(y))))+(((u0)+((-1.0)*(u1)))*(((x)*(x))+((y)*(y))))));
	newgradient[i*2+1] +=((2.0)*1.0/(((L)))*1.0/(((y)))*((((L)*(L))*((v0)+((-1.0)*(v2))))+((L)*(((-2.0)*(v0)*(x))+((v1)*(x))+((v2)*(x))+((u1)*(y))+((-1.0)*(u2)*(y))))+(((v0)+((-1.0)*(v1)))*(((x)*(x))+((y)*(y))))));
	}

	if(ip1 != -1){
	newgradient[ip1*2] += ((2.0)*1.0/(((L)))*1.0/(((y)))*(((L)*(((u0)*(x))+((-1.0)*(u2)*(x))+((v0)*(y))+((-1.0)*(v2)*(y))))+((-1.0)*((u0)+((-1.0)*(u1)))*(((x)*(x))+((y)*(y))))));
	newgradient[ip1*2+1] += ((-2.0)*1.0/(((L)))*1.0/(((y)))*(((L)*(((-1.0)*(v0)*(x))+((v2)*(x))+((u0)*(y))+((-1.0)*(u2)*(y))))+(((v0)+((-1.0)*(v1)))*(((x)*(x))+((y)*(y))))));
	}

	if(j != -1)
	{
	newgradient[j*2] += ((-2.0)*1.0/(((y)))*(((L)*((u0)+((-1.0)*(u2))))+((-1.0)*(u0)*(x))+((u1)*(x))+((v0)*(y))+((-1.0)*(v1)*(y))));
	newgradient[j*2+1] += ((2.0)*1.0/(((y)))*(((L)*(((-1.0)*(v0))+(v2)))+((v0)*(x))+((-1.0)*(v1)*(x))+((u0)*(y))+((-1.0)*(u1)*(y))));
	}
}


double olga_function_tri(double L, double x, double y, double u0, double v0, double u1, double v1, double u2, double v2)
{
	return std::max((2*L*y)/(sqrt(pow(L*u0 - x*u0 + x*u1 - L*u2 - y*v0 + y*v1,2) + 
        pow(u0*y - u1*y + L*v0 - x*v0 + x*v1 - L*v2,2)) - 
      sqrt(pow(L*u0 - x*u0 + x*u1 - L*u2 + y*v0 - y*v1,2) + 
        pow(u0*y - u1*y - L*v0 + x*v0 - x*v1 + L*v2,2))),
   (sqrt(pow(L*u0 - x*u0 + x*u1 - L*u2 - y*v0 + y*v1,2) + 
        pow(u0*y - u1*y + L*v0 - x*v0 + x*v1 - L*v2,2)) + 
      sqrt(pow(L*u0 - x*u0 + x*u1 - L*u2 + y*v0 - y*v1,2) + 
        pow(u0*y - u1*y - L*v0 + x*v0 - x*v1 + L*v2,2)))/(2.*L*y));
}

void olga_function_grad(double *newgradient, double L, double x, double y, double u0, double v0, double u1, double v1, double u2, double v2, int i, int ip1, int j)
{
	if( (L*y - u2*v0 - u0*v1 + u2*v1 + u1*(v0 - v2) + u0*v2)/
   (sqrt(pow(L*u0 - x*u0 + x*u1 - L*u2 - y*v0 + y*v1,2) + 
       pow(u0*y - u1*y + L*v0 - x*v0 + x*v1 - L*v2,2)) - 
     sqrt(pow(L*u0 - x*u0 + x*u1 - L*u2 + y*v0 - y*v1,2) + 
       pow(u0*y - u1*y - L*v0 + x*v0 - x*v1 + L*v2,2))) >= 0)
	{
		if(i != -1)
		{
		newgradient[i*2] += -((L*y*((2*(pow(L,2)*(u0 - u2) + (u0 - u1)*(pow(x,2) + pow(y,2)) + 
              L*(x*(-2*u0 + u1 + u2) + y*(v1 - v2))))/
          sqrt(pow(L*u0 - x*u0 + x*u1 - L*u2 - y*v0 + y*v1,2) + 
            pow(u0*y - u1*y + L*v0 - x*v0 + x*v1 - L*v2,2)) - 
         (2*(pow(L,2)*(u0 - u2) + (u0 - u1)*(pow(x,2) + pow(y,2)) + 
              L*(x*(-2*u0 + u1 + u2) + y*(-v1 + v2))))/
          sqrt(pow(L*u0 - x*u0 + x*u1 - L*u2 + y*v0 - y*v1,2) + 
            pow(u0*y - u1*y - L*v0 + x*v0 - x*v1 + L*v2,2))))/
     pow(sqrt(pow(L*u0 - x*u0 + x*u1 - L*u2 - y*v0 + y*v1,2) + 
         pow(u0*y - u1*y + L*v0 - x*v0 + x*v1 - L*v2,2)) - 
       sqrt(pow(L*u0 - x*u0 + x*u1 - L*u2 + y*v0 - y*v1,2) + 
         pow(u0*y - u1*y - L*v0 + x*v0 - x*v1 + L*v2,2)),2));
		newgradient[i*2+1] +=-((L*y*((-2*((pow(x,2) + pow(y,2))*(v0 - v1) + pow(L,2)*(v0 - v2) + 
              L*(u1*y - u2*y + x*(-2*v0 + v1 + v2))))/
          sqrt(pow(L*u0 - x*u0 + x*u1 - L*u2 + y*v0 - y*v1,2) + 
            pow(u0*y - u1*y - L*v0 + x*v0 - x*v1 + L*v2,2)) + 
         (2*((pow(x,2) + pow(y,2))*(v0 - v1) + pow(L,2)*(v0 - v2) + 
              L*(-(u1*y) + u2*y + x*(-2*v0 + v1 + v2))))/
          sqrt(pow(L*u0 - x*u0 + x*u1 - L*u2 - y*v0 + y*v1,2) + 
            pow(u0*y - u1*y + L*v0 - x*v0 + x*v1 - L*v2,2))))/
     pow(sqrt(pow(L*u0 - x*u0 + x*u1 - L*u2 - y*v0 + y*v1,2) + 
         pow(u0*y - u1*y + L*v0 - x*v0 + x*v1 - L*v2,2)) - 
       sqrt(pow(L*u0 - x*u0 + x*u1 - L*u2 + y*v0 - y*v1,2) + 
         pow(u0*y - u1*y - L*v0 + x*v0 - x*v1 + L*v2,2)),2));
		}

		if(ip1 != -1){
		newgradient[ip1*2] += -((L*y*((2*((-u0 + u1)*(pow(x,2) + pow(y,2)) + L*(x*(u0 - u2) + y*(-v0 + v2))))/
          sqrt(pow(L*u0 - x*u0 + x*u1 - L*u2 - y*v0 + y*v1,2) + 
            pow(u0*y - u1*y + L*v0 - x*v0 + x*v1 - L*v2,2)) + 
         (2*((u0 - u1)*(pow(x,2) + pow(y,2)) + L*(x*(-u0 + u2) + y*(-v0 + v2))))/
          sqrt(pow(L*u0 - x*u0 + x*u1 - L*u2 + y*v0 - y*v1,2) + 
            pow(u0*y - u1*y - L*v0 + x*v0 - x*v1 + L*v2,2))))/
     pow(sqrt(pow(L*u0 - x*u0 + x*u1 - L*u2 - y*v0 + y*v1,2) + 
         pow(u0*y - u1*y + L*v0 - x*v0 + x*v1 - L*v2,2)) - 
       sqrt(pow(L*u0 - x*u0 + x*u1 - L*u2 + y*v0 - y*v1,2) + 
         pow(u0*y - u1*y - L*v0 + x*v0 - x*v1 + L*v2,2)),2));
		newgradient[ip1*2+1] +=  -((L*y*((2*((-pow(x,2) - pow(y,2))*(v0 - v1) + L*(u0*y - u2*y + x*v0 - x*v2)))/
          sqrt(pow(L*u0 - x*u0 + x*u1 - L*u2 - y*v0 + y*v1,2) + 
            pow(u0*y - u1*y + L*v0 - x*v0 + x*v1 - L*v2,2)) + 
         (2*((pow(x,2) + pow(y,2))*(v0 - v1) + L*(u0*y - u2*y - x*v0 + x*v2)))/
          sqrt(pow(L*u0 - x*u0 + x*u1 - L*u2 + y*v0 - y*v1,2) + 
            pow(u0*y - u1*y - L*v0 + x*v0 - x*v1 + L*v2,2))))/
     pow(sqrt(pow(L*u0 - x*u0 + x*u1 - L*u2 - y*v0 + y*v1,2) + 
         pow(u0*y - u1*y + L*v0 - x*v0 + x*v1 - L*v2,2)) - 
       sqrt(pow(L*u0 - x*u0 + x*u1 - L*u2 + y*v0 - y*v1,2) + 
         pow(u0*y - u1*y - L*v0 + x*v0 - x*v1 + L*v2,2)),2));
		}

		if(j != -1)
		{
		newgradient[j*2] += (-2*L*y*((L*(x*(u0 - u1) + L*(-u0 + u2) + y*(v0 - v1)))/
        sqrt(pow(L*u0 - x*u0 + x*u1 - L*u2 - y*v0 + y*v1,2) + 
          pow(u0*y - u1*y + L*v0 - x*v0 + x*v1 - L*v2,2)) + 
       (L*(x*(-u0 + u1) + L*(u0 - u2) + y*(v0 - v1)))/
        sqrt(pow(L*u0 - x*u0 + x*u1 - L*u2 + y*v0 - y*v1,2) + 
          pow(u0*y - u1*y - L*v0 + x*v0 - x*v1 + L*v2,2))))/
   pow(sqrt(pow(L*u0 - x*u0 + x*u1 - L*u2 - y*v0 + y*v1,2) + 
       pow(u0*y - u1*y + L*v0 - x*v0 + x*v1 - L*v2,2)) - 
     sqrt(pow(L*u0 - x*u0 + x*u1 - L*u2 + y*v0 - y*v1,2) + 
       pow(u0*y - u1*y - L*v0 + x*v0 - x*v1 + L*v2,2)),2);
		newgradient[j*2+1] += (-2*L*y*((L*(-(u0*y) + u1*y - L*v0 + x*v0 - x*v1 + L*v2))/
        sqrt(pow(L*u0 - x*u0 + x*u1 - L*u2 - y*v0 + y*v1,2) + 
          pow(u0*y - u1*y + L*v0 - x*v0 + x*v1 - L*v2,2)) + 
       (L*(-(u0*y) + u1*y + L*v0 - x*v0 + x*v1 - L*v2))/
        sqrt(pow(L*u0 - x*u0 + x*u1 - L*u2 + y*v0 - y*v1,2) + 
          pow(u0*y - u1*y - L*v0 + x*v0 - x*v1 + L*v2,2))))/
   pow(sqrt(pow(L*u0 - x*u0 + x*u1 - L*u2 - y*v0 + y*v1,2) + 
       pow(u0*y - u1*y + L*v0 - x*v0 + x*v1 - L*v2,2)) - 
     sqrt(pow(L*u0 - x*u0 + x*u1 - L*u2 + y*v0 - y*v1,2) + 
       pow(u0*y - u1*y - L*v0 + x*v0 - x*v1 + L*v2,2)),2);
		}
	}
	else
	{
		if(i != -1)
		{
		newgradient[i*2] += ((2*(pow(L,2)*(u0 - u2) + (u0 - u1)*(pow(x,2) + pow(y,2)) + 
          L*(x*(-2*u0 + u1 + u2) + y*(v1 - v2))))/
      sqrt(pow(L*u0 - x*u0 + x*u1 - L*u2 - y*v0 + y*v1,2) + 
        pow(u0*y - u1*y + L*v0 - x*v0 + x*v1 - L*v2,2)) + 
     (2*(pow(L,2)*(u0 - u2) + (u0 - u1)*(pow(x,2) + pow(y,2)) + 
          L*(x*(-2*u0 + u1 + u2) + y*(-v1 + v2))))/
      sqrt(pow(L*u0 - x*u0 + x*u1 - L*u2 + y*v0 - y*v1,2) + 
        pow(u0*y - u1*y - L*v0 + x*v0 - x*v1 + L*v2,2)))/(4.*L*y);
		newgradient[i*2+1] +=((2*((pow(x,2) + pow(y,2))*(v0 - v1) + pow(L,2)*(v0 - v2) + 
          L*(u1*y - u2*y + x*(-2*v0 + v1 + v2))))/
      sqrt(pow(L*u0 - x*u0 + x*u1 - L*u2 + y*v0 - y*v1,2) + 
        pow(u0*y - u1*y - L*v0 + x*v0 - x*v1 + L*v2,2)) + 
     (2*((pow(x,2) + pow(y,2))*(v0 - v1) + pow(L,2)*(v0 - v2) + 
          L*(-(u1*y) + u2*y + x*(-2*v0 + v1 + v2))))/
      sqrt(pow(L*u0 - x*u0 + x*u1 - L*u2 - y*v0 + y*v1,2) + 
        pow(u0*y - u1*y + L*v0 - x*v0 + x*v1 - L*v2,2)))/(4.*L*y);
		}

		if(ip1 != -1){
		newgradient[ip1*2] += ((2*((-u0 + u1)*(pow(x,2) + pow(y,2)) + L*(x*(u0 - u2) + y*(v0 - v2))))/
      sqrt(pow(L*u0 - x*u0 + x*u1 - L*u2 + y*v0 - y*v1,2) + 
        pow(u0*y - u1*y - L*v0 + x*v0 - x*v1 + L*v2,2)) + 
     (2*((-u0 + u1)*(pow(x,2) + pow(y,2)) + L*(x*(u0 - u2) + y*(-v0 + v2))))/
      sqrt(pow(L*u0 - x*u0 + x*u1 - L*u2 - y*v0 + y*v1,2) + 
        pow(u0*y - u1*y + L*v0 - x*v0 + x*v1 - L*v2,2)))/(4.*L*y);
		newgradient[ip1*2+1] += ((2*((-pow(x,2) - pow(y,2))*(v0 - v1) + L*(u0*y - u2*y + x*v0 - x*v2)))/
      sqrt(pow(L*u0 - x*u0 + x*u1 - L*u2 - y*v0 + y*v1,2) + 
        pow(u0*y - u1*y + L*v0 - x*v0 + x*v1 - L*v2,2)) + 
     (2*((-pow(x,2) - pow(y,2))*(v0 - v1) + L*(-(u0*y) + u2*y + x*v0 - x*v2)))/
      sqrt(pow(L*u0 - x*u0 + x*u1 - L*u2 + y*v0 - y*v1,2) + 
        pow(u0*y - u1*y - L*v0 + x*v0 - x*v1 + L*v2,2)))/(4.*L*y);
		}

		if(j != -1)
		{
		newgradient[j*2] += -((L*(x*(-u0 + u1) + L*(u0 - u2) + y*(-v0 + v1)))/
       sqrt(pow(L*u0 - x*u0 + x*u1 - L*u2 - y*v0 + y*v1,2) + 
         pow(u0*y - u1*y + L*v0 - x*v0 + x*v1 - L*v2,2)) + 
      (L*(x*(-u0 + u1) + L*(u0 - u2) + y*(v0 - v1)))/
       sqrt(pow(L*u0 - x*u0 + x*u1 - L*u2 + y*v0 - y*v1,2) + 
         pow(u0*y - u1*y - L*v0 + x*v0 - x*v1 + L*v2,2)))/(2.*L*y);
		newgradient[j*2+1] += ((L*(-(u0*y) + u1*y - L*v0 + x*v0 - x*v1 + L*v2))/
      sqrt(pow(L*u0 - x*u0 + x*u1 - L*u2 - y*v0 + y*v1,2) + 
        pow(u0*y - u1*y + L*v0 - x*v0 + x*v1 - L*v2,2)) + 
     (L*(u0*y - u1*y - L*v0 + x*v0 - x*v1 + L*v2))/
      sqrt(pow(L*u0 - x*u0 + x*u1 - L*u2 + y*v0 - y*v1,2) + 
        pow(u0*y - u1*y - L*v0 + x*v0 - x*v1 + L*v2,2)))/(2.*L*y);
		}
	}


}
